<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>DongSheng&#39;s Blog</title>
  <icon>https://www.gravatar.com/avatar/2e394ffb56f8f004acd7419b61a7c933</icon>
  <subtitle>记录点滴，不断突破</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://mds1455975151.github.io/"/>
  <updated>2020-05-09T13:16:08.527Z</updated>
  <id>https://mds1455975151.github.io/</id>
  
  <author>
    <name>DongSheng</name>
    <email>madscdpc@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>自动化测试工具appium部署</title>
    <link href="https://mds1455975151.github.io/archives/134400db.html"/>
    <id>https://mds1455975151.github.io/archives/134400db.html</id>
    <published>2020-05-09T13:06:28.000Z</published>
    <updated>2020-05-09T13:16:08.527Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:16:23 GMT+0800 (GMT+08:00) --><blockquote><p>协助公司测试同事部署下自动化测试工具Appium</p></blockquote><a id="more"></a><p>记录下，共享给有需要的朋友。安装不得方法，各种报错让人抓狂。</p><p>要点:</p><ul><li>安装最新稳定版本node，系统默认的版本都比较低</li><li>使用cnmp替代npm(解决下载依赖速度问题)</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">wget https://nodejs.org/dist/v12.16.3/node-v12.16.3-linux-x64.tar.xz</span><br><span class="line">xz -d node-v12.16.3-linux-x64.tar.xz</span><br><span class="line">tar -xf node-v12.16.3-linux-x64.tar -C /usr/local/</span><br><span class="line">cd /usr/local/ &amp;&amp; ln -s node-v12.16.3-linux-x64 node</span><br><span class="line">cat&gt;&gt;/etc/profile&lt;&lt;EOF</span><br><span class="line"></span><br><span class="line"># set for nodejs</span><br><span class="line">export NODE_HOME=/usr/local/node</span><br><span class="line">export PATH=\$NODE_HOME/bin:\$PATH</span><br><span class="line">EOF</span><br><span class="line">source  /etc/profile</span><br><span class="line">node -v</span><br><span class="line"></span><br><span class="line">npm install -g cnpm --registry=https://registry.npm.taobao.org</span><br><span class="line">cnpm install -g appium</span><br></pre></td></tr></table></figure><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li><a href="https://www.toutiao.com/c/user/3916271538/#mid=1560038863835138" target="_blank" rel="noopener">今日头条</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/134400db.html">https://mds1455975151.github.io/archives/134400db.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      自动化测试工具Appium部署
    
    </summary>
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/categories/DevOps/"/>
    
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/tags/DevOps/"/>
    
      <category term="自动化测试" scheme="https://mds1455975151.github.io/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/"/>
    
      <category term="Appium" scheme="https://mds1455975151.github.io/tags/Appium/"/>
    
  </entry>
  
  <entry>
    <title>运维工程师-非专业安全人员如何确保企业信息安全</title>
    <link href="https://mds1455975151.github.io/archives/c747a9a8.html"/>
    <id>https://mds1455975151.github.io/archives/c747a9a8.html</id>
    <published>2020-04-11T08:16:44.000Z</published>
    <updated>2020-04-11T08:19:31.257Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>企业信息安全守则</p></blockquote><a id="more"></a><ul><li>关于权限，各类授权都遵循最小化授权原则，能授权IP不授权网段，能授权指定端口不授权ALL</li><li>各类服务使用普通账号启动，软件目录授权最小化</li><li>各类密码复杂度要求，并要求定期3个月更新</li><li>线上操作行为审计需要部署堡垒机</li><li>公司外部办公使用OpenVPN+堡垒机方式</li><li>员工电脑全部要求按照杀毒软件，确保企业内部网络安全</li><li>做好业务监控发现问题及时纠正解决</li><li>各类应用软件隐藏版本信息，及时更新到最新稳定版本</li><li>使用Openresty实现web应用防火墙，可以阻挡一些安全攻击，例如：SQL注释，CC攻击、API接口安全</li><li>定期员工培训，强调企业安全防范意识</li><li>时刻关注各类安全事件，加强防范意识</li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li><a href="https://www.toutiao.com/c/user/3916271538/#mid=1560038863835138" target="_blank" rel="noopener">今日头条</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/c747a9a8.html">https://mds1455975151.github.io/archives/c747a9a8.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      企业信息安全
    
    </summary>
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/categories/DevOps/"/>
    
    
      <category term="企业信息安全" scheme="https://mds1455975151.github.io/tags/%E4%BC%81%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/"/>
    
      <category term="运维工程师" scheme="https://mds1455975151.github.io/tags/%E8%BF%90%E7%BB%B4%E5%B7%A5%E7%A8%8B%E5%B8%88/"/>
    
  </entry>
  
  <entry>
    <title>HashiCorp Vault入门介绍</title>
    <link href="https://mds1455975151.github.io/archives/ff02dc0f.html"/>
    <id>https://mds1455975151.github.io/archives/ff02dc0f.html</id>
    <published>2020-04-11T06:35:31.000Z</published>
    <updated>2020-04-11T08:02:07.866Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>HashiCorp Vault是一款企业级私密信息管理工具。说起Vault，不得不提它的创造者HashiCorp公司。HashiCorp是一家专注于DevOps工具链的公司，其旗下明星级产品包括Vagrant、Packer、Terraform、Consul、Nomad等，再加上Vault，这些工具贯穿了持续交付的整个流程。</p></blockquote><a id="more"></a><p><img src="/archives/ff02dc0f/04.png" alt="image"></p><h1 id="为什么使用HashiCorp-Vault？"><a href="#为什么使用HashiCorp-Vault？" class="headerlink" title="为什么使用HashiCorp Vault？"></a>为什么使用HashiCorp Vault？</h1><p>企业内各类私密信息安全存储问题需求，例如:ssh key,各类API认证信息，数据库权限等等</p><h1 id="HashiCorp-Vault优势"><a href="#HashiCorp-Vault优势" class="headerlink" title="HashiCorp Vault优势"></a>HashiCorp Vault优势</h1><p>HashiCorp Vault作为集中化的私密信息管理工具，具有以下特点：</p><ul><li>存储私密信息<br>不仅可以存放现有的私密信息，还可以动态生成用于管理第三方资源的私密信息。所有存放的数据都是加密的，任何动态生成的私密信息都有租期，并且到期会自动回收。</li><li>滚动更新秘钥<br>用户可以随时更新存放的私密信息。Vault提供了加密即服务（encryption-as-a-service）的功能，可以随时将密钥滚动到新的密钥版本，同时保留对使用过去密钥版本加密的值进行解密的能力。 对于动态生成的秘密，可配置的最大租赁寿命确保密钥滚动易于实施。</li><li>审计日志<br>保管库存储所有经过身份验证的客户端交互的详细审核日志：身份验证，令牌创建，私密信息访问，私密信息撤销等。 可以将审核日志发送到多个后端以确保冗余副本。</li></ul><p>另外，HaishiCorp Vault提供了多种方式来管理私密信息。用户可以通过命令行、HTTP API等集成到应用中来获取私密信息。HashiCorp Vault也能与Ansible、Chef、Consul等DevOps工具链无缝结合使用。</p><h1 id="HashiCorp-Vault实践"><a href="#HashiCorp-Vault实践" class="headerlink" title="HashiCorp Vault实践"></a>HashiCorp Vault实践</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# wget https://releases.hashicorp.com/vault/1.4.0/vault_1.4.0_linux_arm64.zip</span><br><span class="line">[root@node01 ~]# unzip vault_1.4.0_linux_arm64.zip</span><br><span class="line">[root@node01 ~]# install vault /usr/local/bin/</span><br><span class="line"></span><br><span class="line">[root@node01 ~]# vault server -dev-listen-address=0.0.0.0:8200 --dev</span><br><span class="line">==&gt; Vault server configuration:</span><br><span class="line"></span><br><span class="line">             Api Address: http://0.0.0.0:8200</span><br><span class="line">                     Cgo: disabled</span><br><span class="line">         Cluster Address: https://0.0.0.0:8201</span><br><span class="line">              Listener 1: tcp (addr: &quot;0.0.0.0:8200&quot;, cluster address: &quot;0.0.0.0:8201&quot;, max_request_duration: &quot;1m30s&quot;, max_request_size: &quot;33554432&quot;, tls: &quot;disabled&quot;)</span><br><span class="line">               Log Level: info</span><br><span class="line">                   Mlock: supported: true, enabled: false</span><br><span class="line">           Recovery Mode: false</span><br><span class="line">                 Storage: inmem</span><br><span class="line">                 Version: Vault v1.4.0</span><br><span class="line"></span><br><span class="line">WARNING! dev mode is enabled! In this mode, Vault runs entirely in-memory</span><br><span class="line">and starts unsealed with a single unseal key. The root token is already</span><br><span class="line">authenticated to the CLI, so you can immediately begin using Vault.</span><br><span class="line"></span><br><span class="line">You may need to set the following environment variable:</span><br><span class="line"></span><br><span class="line">    $ export VAULT_ADDR=&apos;http://0.0.0.0:8200&apos;</span><br><span class="line"></span><br><span class="line">The unseal key and root token are displayed below in case you want to</span><br><span class="line">seal/unseal the Vault or re-authenticate.</span><br><span class="line"></span><br><span class="line">Unseal Key: t8B6LCmjcX4mc2cx5XDjzLkYzd1ZSX1Fn3rkq3p50P4=</span><br><span class="line">Root Token: s.yOXkEpKd27M5eYRC1Knv3T6D</span><br><span class="line"></span><br><span class="line">Development mode should NOT be used in production installations!</span><br><span class="line"></span><br><span class="line">==&gt; Vault server started! Log data will stream in below:</span><br><span class="line"></span><br><span class="line">2020-04-11T10:55:49.813+0800 [INFO]  proxy environment: http_proxy= https_proxy= no_proxy=</span><br><span class="line">2020-04-11T10:55:49.813+0800 [WARN]  no `api_addr` value specified in config or in VAULT_API_ADDR; falling back to detection if possible, but this value should be manually set</span><br><span class="line">2020-04-11T10:55:49.813+0800 [ERROR] core: no seal config found, can&apos;t determine if legacy or new-style shamir</span><br><span class="line">2020-04-11T10:55:49.813+0800 [ERROR] core: no seal config found, can&apos;t determine if legacy or new-style shamir</span><br><span class="line">2020-04-11T10:55:49.813+0800 [INFO]  core: security barrier not initialized</span><br><span class="line">2020-04-11T10:55:49.813+0800 [INFO]  core: security barrier initialized: stored=1 shares=1 threshold=1</span><br><span class="line">2020-04-11T10:55:49.814+0800 [INFO]  core: post-unseal setup starting</span><br><span class="line">2020-04-11T10:55:49.824+0800 [INFO]  core: loaded wrapping token key</span><br><span class="line">2020-04-11T10:55:49.824+0800 [INFO]  core: successfully setup plugin catalog: plugin-directory=</span><br><span class="line">2020-04-11T10:55:49.824+0800 [INFO]  core: no mounts; adding default mount table</span><br><span class="line">2020-04-11T10:55:49.825+0800 [INFO]  core: successfully mounted backend: type=cubbyhole path=cubbyhole/</span><br><span class="line">2020-04-11T10:55:49.825+0800 [INFO]  core: successfully mounted backend: type=system path=sys/</span><br><span class="line">2020-04-11T10:55:49.826+0800 [INFO]  core: successfully mounted backend: type=identity path=identity/</span><br><span class="line">2020-04-11T10:55:49.827+0800 [INFO]  core: successfully enabled credential backend: type=token path=token/</span><br><span class="line">2020-04-11T10:55:49.827+0800 [INFO]  core: restoring leases</span><br><span class="line">2020-04-11T10:55:49.827+0800 [INFO]  rollback: starting rollback manager</span><br><span class="line">2020-04-11T10:55:49.828+0800 [INFO]  expiration: lease restore complete</span><br><span class="line">2020-04-11T10:55:49.831+0800 [INFO]  identity: entities restored</span><br><span class="line">2020-04-11T10:55:49.831+0800 [INFO]  identity: groups restored</span><br><span class="line">2020-04-11T10:55:49.831+0800 [INFO]  core: post-unseal setup complete</span><br><span class="line">2020-04-11T10:55:49.832+0800 [INFO]  core: root token generated</span><br><span class="line">2020-04-11T10:55:49.832+0800 [INFO]  core: pre-seal teardown starting</span><br><span class="line">2020-04-11T10:55:49.832+0800 [INFO]  rollback: stopping rollback manager</span><br><span class="line">2020-04-11T10:55:49.832+0800 [INFO]  core: pre-seal teardown complete</span><br><span class="line">2020-04-11T10:55:49.832+0800 [ERROR] core: no seal config found, can&apos;t determine if legacy or new-style shamir</span><br><span class="line">2020-04-11T10:55:49.832+0800 [INFO]  core.cluster-listener.tcp: starting listener: listener_address=0.0.0.0:8201</span><br><span class="line">2020-04-11T10:55:49.832+0800 [INFO]  core.cluster-listener: serving cluster requests: cluster_listen_address=[::]:8201</span><br><span class="line">2020-04-11T10:55:49.832+0800 [INFO]  core: post-unseal setup starting</span><br><span class="line">2020-04-11T10:55:49.832+0800 [INFO]  core: loaded wrapping token key</span><br><span class="line">2020-04-11T10:55:49.832+0800 [INFO]  core: successfully setup plugin catalog: plugin-directory=</span><br><span class="line">2020-04-11T10:55:49.832+0800 [INFO]  core: successfully mounted backend: type=system path=sys/</span><br><span class="line">2020-04-11T10:55:49.833+0800 [INFO]  core: successfully mounted backend: type=identity path=identity/</span><br><span class="line">2020-04-11T10:55:49.833+0800 [INFO]  core: successfully mounted backend: type=cubbyhole path=cubbyhole/</span><br><span class="line">2020-04-11T10:55:49.833+0800 [INFO]  core: successfully enabled credential backend: type=token path=token/</span><br><span class="line">2020-04-11T10:55:49.833+0800 [INFO]  core: restoring leases</span><br><span class="line">2020-04-11T10:55:49.833+0800 [INFO]  rollback: starting rollback manager</span><br><span class="line">2020-04-11T10:55:49.833+0800 [INFO]  identity: entities restored</span><br><span class="line">2020-04-11T10:55:49.833+0800 [INFO]  identity: groups restored</span><br><span class="line">2020-04-11T10:55:49.833+0800 [INFO]  core: post-unseal setup complete</span><br><span class="line">2020-04-11T10:55:49.833+0800 [INFO]  core: vault is unsealed</span><br><span class="line">2020-04-11T10:55:49.835+0800 [INFO]  core: successful mount: namespace= path=secret/ type=kv</span><br><span class="line">2020-04-11T10:55:49.836+0800 [INFO]  expiration: lease restore complete</span><br><span class="line">2020-04-11T10:55:49.836+0800 [INFO]  secrets.kv.kv_bb6143ab: collecting keys to upgrade</span><br><span class="line">2020-04-11T10:55:49.836+0800 [INFO]  secrets.kv.kv_bb6143ab: done collecting keys: num_keys=1</span><br><span class="line">2020-04-11T10:55:49.836+0800 [INFO]  secrets.kv.kv_bb6143ab: upgrading keys finished</span><br></pre></td></tr></table></figure><p>运行起来后检查下应用信息<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@node01 ~]# vault status</span><br><span class="line">Key             Value</span><br><span class="line">---             -----</span><br><span class="line">Seal Type       shamir</span><br><span class="line">Initialized     true</span><br><span class="line">Sealed          false</span><br><span class="line">Total Shares    1</span><br><span class="line">Threshold       1</span><br><span class="line">Version         1.4.0</span><br><span class="line">Cluster Name    vault-cluster-7a108e78</span><br><span class="line">Cluster ID      87b55947-d512-6a0f-a6ab-91e89ea3f4f9</span><br><span class="line">HA Enabled      false</span><br><span class="line">[root@node01 ~]# vault auth list</span><br><span class="line">Path      Type     Accessor               Description</span><br><span class="line">----      ----     --------               -----------</span><br><span class="line">token/    token    auth_token_d4a43357    token based credentials</span><br></pre></td></tr></table></figure><p></p><h1 id="UI界面体验"><a href="#UI界面体验" class="headerlink" title="UI界面体验"></a>UI界面体验</h1><p>登陆地址: <a href="http://{ip}:8200/ui/" target="_blank" rel="noopener">http://{ip}:8200/ui/</a><br><img src="/archives/ff02dc0f/01.png" alt="image"><br>启动后默认会生成一个token信息，每次都会变化，使用该token登陆。Vault支持很多主流认证方式，根据需要增加其他认证方式，本人测试使用的是OpenLDAP。<br><img src="/archives/ff02dc0f/02.png" alt="image"><br>支持的密钥引擎<br><img src="/archives/ff02dc0f/03.png" alt="image"><br>界面就这么内容，很多操作还是依赖于命令行操作。</p><h1 id="启用OpenLDAP认证"><a href="#启用OpenLDAP认证" class="headerlink" title="启用OpenLDAP认证"></a>启用OpenLDAP认证</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vault auth enable ldap</span><br><span class="line"></span><br><span class="line">vault write auth/ldap/config \</span><br><span class="line">    url=&quot;ldap://master-ldap.xxx.com:389&quot; \</span><br><span class="line">    userdn=&quot;cn=Users,dc=xxx,dc=com&quot; \</span><br><span class="line">    groupfilter=&quot;(&amp;(objectClass=person)(uid=&#123;&#123;.Username&#125;&#125;))&quot; \</span><br><span class="line">    groupattr=&quot;memberOf&quot; \</span><br><span class="line">    binddn=&quot;cn=admin,dc=xxx,dc=com&quot; \</span><br><span class="line">    bindpass=&apos;xxx&apos; \</span><br><span class="line">    insecure_tls=false \</span><br><span class="line">    starttls=false</span><br></pre></td></tr></table></figure><blockquote><p>修改配置信息重新执行命令即可更新</p></blockquote><h1 id="业务实践"><a href="#业务实践" class="headerlink" title="业务实践"></a>业务实践</h1><p>基于Vault实现Linux服务器一次性SSH密码登陆</p><ul><li><a href="https://learn.hashicorp.com/vault/secrets-management/sm-ssh-otp" target="_blank" rel="noopener">官网案例</a></li><li><a href="https://releases.hashicorp.com/vault-ssh-helper" target="_blank" rel="noopener">vault-ssh-helper</a></li></ul><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li><a href="https://github.com/hashicorp/vault-ssh-helper" target="_blank" rel="noopener">https://github.com/hashicorp/vault-ssh-helper</a></li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li><a href="https://www.toutiao.com/c/user/3916271538/#mid=1560038863835138" target="_blank" rel="noopener">今日头条</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/ff02dc0f.html">https://mds1455975151.github.io/archives/ff02dc0f.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      HashiCorp Vault一款企业级私密信息管理工具
    
    </summary>
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/categories/DevOps/"/>
    
    
      <category term="HashiCorp" scheme="https://mds1455975151.github.io/tags/HashiCorp/"/>
    
      <category term="Vault" scheme="https://mds1455975151.github.io/tags/Vault/"/>
    
  </entry>
  
  <entry>
    <title>YAPI高效易用功能强大的API开发者设计的管理平台</title>
    <link href="https://mds1455975151.github.io/archives/a8bd9fbc.html"/>
    <id>https://mds1455975151.github.io/archives/a8bd9fbc.html</id>
    <published>2020-04-10T08:02:33.000Z</published>
    <updated>2020-04-10T10:20:47.400Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><p>&gt;<br>每天都有大量的API增长，随着移动应用以及智能设备爆发增长，同时越来越多的零售商、媒体、政府和金融服务公司开始公开Web API，未来API将会使用的越来越多，包括更多的M2M（机器到机器）的通信。现在，每日API调用量在不断飙升，如何能够安全有效将这些API管理起来对于企业而言并不容易。<br><a id="more"></a></p><h1 id="YAPI概述"><a href="#YAPI概述" class="headerlink" title="YAPI概述"></a>YAPI概述</h1><p>这里推荐一款API管理工具，可以让企业内部接口开发更简单高效，让接口的管理更具可读性、可维护性，让团队协作更合理。</p><ul><li>GitHub地址: <a href="https://github.com/YMFE/yapi" target="_blank" rel="noopener">https://github.com/YMFE/yapi</a></li><li>官网地址: <a href="http://yapi.demo.qunar.com/" target="_blank" rel="noopener">http://yapi.demo.qunar.com/</a></li><li>官网文档: <a href="https://hellosean1025.github.io/yapi/documents/index.html" target="_blank" rel="noopener">https://hellosean1025.github.io/yapi/documents/index.html</a></li></ul><p>优势:</p><ul><li>提供基本的项目分组，项目管理，接口管理功能(对接已有管理平台)</li><li>友好的接口文档，基于websocket的多人协作接口编辑功能和类postman测试工具，让多人协作成倍提升开发效率</li><li>基于Mockjs,使用简单功能强大</li></ul><h1 id="部署实践-快速高效Docker部署方式"><a href="#部署实践-快速高效Docker部署方式" class="headerlink" title="部署实践(快速高效Docker部署方式)"></a>部署实践(快速高效Docker部署方式)</h1><p><a href="https://github.com/jinfeijie/yapi" target="_blank" rel="noopener">https://github.com/jinfeijie/yapi</a><br><a href="https://github.com/fjc0k/docker-YApi" target="_blank" rel="noopener">https://github.com/fjc0k/docker-YApi</a></p><p>ymfe.org<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">docker run -d --name yapi-mongo -p 27017:27017 mongo</span><br><span class="line">npm install -g yapi-cli --registry https://registry.npm.taobao.org</span><br><span class="line">yapi server</span><br></pre></td></tr></table></figure><p></p><h1 id="最佳实践"><a href="#最佳实践" class="headerlink" title="最佳实践"></a>最佳实践</h1><ul><li>关闭注册</li><li>OpenLDAP接入<h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1></li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li><a href="https://www.toutiao.com/c/user/3916271538/#mid=1560038863835138" target="_blank" rel="noopener">今日头条</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/a8bd9fbc.html">https://mds1455975151.github.io/archives/a8bd9fbc.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      高效，易用，功能强大的API开发者设计的管理平台
    
    </summary>
    
      <category term="API管理" scheme="https://mds1455975151.github.io/categories/API%E7%AE%A1%E7%90%86/"/>
    
    
      <category term="OpenLDAP" scheme="https://mds1455975151.github.io/tags/OpenLDAP/"/>
    
      <category term="YAPI" scheme="https://mds1455975151.github.io/tags/YAPI/"/>
    
      <category term="API管理" scheme="https://mds1455975151.github.io/tags/API%E7%AE%A1%E7%90%86/"/>
    
      <category term="Opay" scheme="https://mds1455975151.github.io/tags/Opay/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="https://mds1455975151.github.io/archives/4a17b156.html"/>
    <id>https://mds1455975151.github.io/archives/4a17b156.html</id>
    <published>2020-04-03T07:09:13.991Z</published>
    <updated>2020-04-03T07:09:13.991Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><p>Welcome to <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="noopener">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="noopener">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="noopener">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">"My New Post"</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="noopener">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="noopener">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="noopener">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="noopener">Deployment</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a> <img src="/archives/f7ea3e07/zhifubao.jpg" width="50%"></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/4a17b156.html">https://mds1455975151.github.io/archives/4a17b156.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      
      
        &lt;script src=&quot;/assets/js/APlayer.min.js&quot;&gt; &lt;/script&gt;&lt;!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;Welcome to &lt;a href=&quot;ht
      
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>运维监控体系总结</title>
    <link href="https://mds1455975151.github.io/archives/a5e4dbc5.html"/>
    <id>https://mds1455975151.github.io/archives/a5e4dbc5.html</id>
    <published>2020-04-02T07:00:10.000Z</published>
    <updated>2020-04-08T00:16:54.954Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>运维监控体系总结</p></blockquote><p>总结归纳运维工作中的监控内容。<br><a id="more"></a></p><h1 id="监控目标"><a href="#监控目标" class="headerlink" title="监控目标"></a>监控目标</h1><p>明白监控的重要性以及使用监控要实现的业务目标<br>通常包括以下三点:</p><ul><li>对目标系统进行实时监控</li><li>监控可以实时反馈目标系统的当前状态<br>目标系统硬件、软件、业务是否正常、目前处于何种状态</li><li>保证目标系统可靠性，业务可以持续稳定运行<br>有问题第一时间反馈出来，便于运维人员处理</li></ul><h1 id="监控方法"><a href="#监控方法" class="headerlink" title="监控方法"></a>监控方法</h1><ul><li>了解监控对象<br>例如:CPU如何工作？</li><li>性能基准指标<br>例如: CPU使用率、负载、用户态、内核态、上下文切换</li><li>报警阈值定义<br>例如: CPU负载高的定义，内核态、用户态多少算高</li><li>故障处理流程<br>如何更高效处理故障的流程</li></ul><h1 id="监控核心"><a href="#监控核心" class="headerlink" title="监控核心"></a>监控核心</h1><ul><li>发现问题</li><li>定位问题</li><li>解决问题</li><li>总结问题，对故障原因及问题防范进行归纳总结，避免以后重复出现</li></ul><h1 id="监控工具"><a href="#监控工具" class="headerlink" title="监控工具"></a>监控工具</h1><ul><li>老牌监控<ul><li>Cacti</li><li>Nagios</li><li>smokeping</li><li>等等产品</li></ul></li><li>流行监控<ul><li>Zabbix</li><li>OpenFalcon</li><li>Prometheus+Grafana</li><li>滴滴开源夜莺Nightingale</li><li>smartping(专用于网络监控)</li><li>LEPUS天兔(专用于监控数据库)</li></ul></li><li>自研</li><li>第三方监控<ul><li>监控宝</li><li>听云</li></ul></li></ul><h1 id="监控流程"><a href="#监控流程" class="headerlink" title="监控流程"></a>监控流程</h1><ul><li>采集<br>通过SNMP、Agent、ICMP、SSH、IPMI等对系统进行数据采集</li><li>存储<br>各类数据库服务,MySQL、PostgreSQL</li><li>分析<br>提供图形及时间线情况信息，方便我们定位故障所在</li><li>展示<br>指标信息、指标趋势展示</li><li>报警<br>电话、邮件、微信、短信、报警升级机制</li><li>处理<br>故障级别判定，找响应人员进行快速处理</li></ul><h1 id="监控指标"><a href="#监控指标" class="headerlink" title="监控指标"></a>监控指标</h1><ul><li>硬件监控<ul><li>机器硬件:CPU温度、物理磁盘、虚拟磁盘、主板温度、磁盘阵列</li><li>IPMI工具无法获取到硬件的状态，可以借助MegaCli工具探测Raid磁盘队列状态</li><li><a href="https://www.ibm.com/developerworks/cn/linux/l-ipmi/" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/linux/l-ipmi/</a></li></ul></li><li>系统监控<ul><li>主机存活</li><li>CPU、内存、硬盘、使用率</li><li>inode</li><li>负载</li><li>网卡出入带宽</li><li>TCP连接数</li><li>磁盘读写、只读</li></ul></li><li>应用监控<ul><li>MySQL<ul><li>服务可用性</li><li>内存使用率</li><li>磁盘使用</li><li>主从不同步及延迟</li><li>备份情况</li><li>连接数</li></ul></li><li>Redis、Redis Cluster<ul><li>负载</li><li>内存使用率</li><li>连接数量</li><li>qps</li></ul></li><li>Nginx<ul><li>状态码</li><li>连接状态信息</li></ul></li><li>RabbitMQ</li><li>PHP-FPM</li><li>OpenLDAP<ul><li>接入IP</li><li>调用次数</li></ul></li><li>Zimbra</li><li>OpenVPN<ul><li>版本信息、当前在线</li><li>用户、分配IP、客户端连接IP、通过IP获取地址位置、接收发送流量 连接时间 时长 连接ID</li></ul></li><li>ELK</li><li>Graylog</li><li>GitLab</li><li>Jenkins</li><li>MongoDB</li><li>HAproxy</li></ul></li><li>网络监控<ul><li>网络质量</li><li>公网出口</li><li>专线带宽</li><li>网络设备</li></ul></li><li>流量分析</li><li>日志监控</li><li>安全监控</li><li>URL、API监控<ul><li><a href="https://github.com/brotandgames/ciao" target="_blank" rel="noopener">https://github.com/brotandgames/ciao</a> 简单易用</li><li><a href="https://github.com/710leo/urlooker" target="_blank" rel="noopener">https://github.com/710leo/urlooker</a></li><li>自研</li><li>阿里云方案</li></ul></li><li>性能监控(APM)java|php|go|nodejs|分布式链路追踪<ul><li>PinPoint</li><li>Zipkin</li><li>SkyWalking</li><li>CAT、Jaeger</li></ul></li><li>业务监控<ul><li>电商业务为例<ul><li>每分钟产生多少订单</li><li>每分钟注册多少用户</li><li>每分钟多少活跃用户</li><li>每天有多少推广活动</li><li>推广活动引入多少用户</li><li>推广活动引入多少流量</li><li>推广活动引入多少利润</li></ul></li></ul></li><li>其他<ul><li>SSL证书监控</li><li>存活性 进程是否还在，端口监听、Log滚动</li><li>健康指标 MQ消息堆积量</li><li>接口监控 API成功率，延迟情况，QPS等等</li></ul></li></ul><h1 id="监控报警"><a href="#监控报警" class="headerlink" title="监控报警"></a>监控报警</h1><ul><li>邮件</li><li>短信</li><li>钉钉、微信、企业微信等其他即时通信软件</li><li>电话</li></ul><h1 id="报警处理"><a href="#报警处理" class="headerlink" title="报警处理"></a>报警处理</h1><ul><li>故障自愈: 服务器宕机自动启动。利用软件机制supervisor,systemd或者自定义脚本实现</li></ul><h1 id="面试监控"><a href="#面试监控" class="headerlink" title="面试监控"></a>面试监控</h1><ul><li>硬件监控<br>通过SNMP来进行路由器交换机的监控、其他内容使用IPMI实现。如果都是公有云，可以忽略这部分内容。案例:<a href="https://www.mdslq.cn/archives/186e54d8.html" target="_blank" rel="noopener">Open-Falcon监控H3C-ER3260G2路由器</a></li><li>系统监控</li><li>服务监控<ul><li>服务自带<ul><li>Nginx自带status模块</li><li>PHP相应status模块</li><li>MySQL利用percona官方工具进行监控</li></ul></li><li>通过自定义方法获取数据<ul><li>MySQL show global status xxx;</li><li>Redis info指令信息</li></ul></li></ul></li><li>网络监控(混合云架构)<ul><li>smokeping</li><li>smartping</li></ul></li><li>安全监控<ul><li>云服务直接用云安全组即可，或者补充本机iptables</li><li>硬件防火墙</li><li>Web服务使用Nginx+Lua实现Web层面的防火墙，或者Openresty</li></ul></li><li>日志监控<br>ELK、Graylog实现异常日志，错误日志关键字的监控</li><li>业务监控<br>确定监控指标，监控起来，业务不同各不相同</li><li>流量分析<br>建议使用百度统计，google统计，商业，研发嵌入代码实现。或者使用<a href="http://www.piwik.cn/" target="_blank" rel="noopener">piwik</a></li><li>可视化<br>dashboard</li><li>自动化监控<br>通过API,批量操作</li></ul><h1 id="监控总结"><a href="#监控总结" class="headerlink" title="监控总结"></a>监控总结</h1><p>完整的监控系统，需要对业务有详尽的了解，软件只是手段。</p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li><a href="https://blog.csdn.net/Z_GodGirl/article/details/81562455" target="_blank" rel="noopener">https://blog.csdn.net/Z_GodGirl/article/details/81562455</a></li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li><a href="https://www.toutiao.com/c/user/3916271538/#mid=1560038863835138" target="_blank" rel="noopener">今日头条</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/a5e4dbc5.html">https://mds1455975151.github.io/archives/a5e4dbc5.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      运维监控体系总结
    
    </summary>
    
    
      <category term="监控" scheme="https://mds1455975151.github.io/tags/%E7%9B%91%E6%8E%A7/"/>
    
      <category term="Zabbix" scheme="https://mds1455975151.github.io/tags/Zabbix/"/>
    
  </entry>
  
  <entry>
    <title>运维系统开发</title>
    <link href="https://mds1455975151.github.io/archives/fba70938.html"/>
    <id>https://mds1455975151.github.io/archives/fba70938.html</id>
    <published>2020-03-28T04:42:47.000Z</published>
    <updated>2020-04-03T07:09:14.101Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>运维系统开发展示</p></blockquote><p>Python3+Flask+ Bootstrap+javascript快速开发运维系统<br><a id="more"></a></p><h1 id="涉及技术"><a href="#涉及技术" class="headerlink" title="涉及技术"></a>涉及技术</h1><p>1、语言及框架 Python3+Flask+MySQL+Redis+Celery+Bootstrap+Echarts<br>2、应用公有云及各类服务 SDK 调用各类服务 API 实现业务需求</p><h1 id="实现功能"><a href="#实现功能" class="headerlink" title="实现功能"></a>实现功能</h1><p>1、CMDB 实现各类资源信息汇总，提供API接口供业务调用<br>2、域名解析、免费SSL证书申请及上传到指定公有云功能<br>3、JumpServer 自动化工具，包括用户初始化、批量授权、信息统计<br>4、OpenLDAP 管理，实现用户组、用户的增删改查、密码重置、入职离职账号管理<br>5、运维信息展示面板便于运维信息查找及便捷操作(Gitlab、Phabricator、Jenkins、Zabbix、Granfana 等各类信息)<br>6、知识库功能，可以编写文章或者上传PDF格式文档，便于各项目信息汇总及文档规范<br>7、数据备份功能，可以展示及汇总各业务数据备份情况<br>8、系统登录、操作行为审计、可以查看用户进行的各类操作<br>9、使用Casbin实现系统权限管理，可以针对服务和接口实现精细化授权<br>10、成本中心功能，计算汇总各项目各类费用支出情况，便于项目成本掌控</p><h1 id="效果展示"><a href="#效果展示" class="headerlink" title="效果展示"></a>效果展示</h1><p><img src="/archives/fba70938/01.png" alt=""><br><img src="/archives/fba70938/02.png" alt=""><br><img src="/archives/fba70938/03.png" alt=""><br><img src="/archives/fba70938/04.png" alt=""><br><img src="/archives/fba70938/05.png" alt=""><br><img src="/archives/fba70938/06.png" alt=""><br><img src="/archives/fba70938/07.png" alt=""><br><img src="/archives/fba70938/08.png" alt=""><br><img src="/archives/fba70938/09.png" alt=""><br><img src="/archives/fba70938/10.png" alt=""><br><img src="/archives/fba70938/11.png" alt=""><br><img src="/archives/fba70938/12.png" alt=""><br><img src="/archives/fba70938/13.png" alt=""></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li><li><a href="https://www.toutiao.com/c/user/3916271538/#mid=1560038863835138" target="_blank" rel="noopener">今日头条</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/fba70938.html">https://mds1455975151.github.io/archives/fba70938.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      运维系统开发
    
    </summary>
    
      <category term="运维系统开发" scheme="https://mds1455975151.github.io/categories/%E8%BF%90%E7%BB%B4%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91/"/>
    
    
      <category term="运维" scheme="https://mds1455975151.github.io/tags/%E8%BF%90%E7%BB%B4/"/>
    
      <category term="Flask" scheme="https://mds1455975151.github.io/tags/Flask/"/>
    
      <category term="Python3" scheme="https://mds1455975151.github.io/tags/Python3/"/>
    
  </entry>
  
  <entry>
    <title>OpenLDAP集中认证管理知识汇总</title>
    <link href="https://mds1455975151.github.io/archives/5724c435.html"/>
    <id>https://mds1455975151.github.io/archives/5724c435.html</id>
    <published>2019-10-27T10:34:25.000Z</published>
    <updated>2020-04-11T08:03:26.460Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>OpenLDAP集中认证管理知识汇总</p></blockquote><a id="more"></a><h1 id="OpenLDAP介绍"><a href="#OpenLDAP介绍" class="headerlink" title="OpenLDAP介绍"></a>OpenLDAP介绍</h1><p>OpenLDAP是一款轻量级目录访问协议（Lightweight Directory Access Protocol，LDAP），属于开源集中账号管理架构的实现，且支持众多系统版本，被广大互联网公司所采用。</p><p>正常端口389或者使用加密端口636。</p><h1 id="OpenLDAP应用点讲解"><a href="#OpenLDAP应用点讲解" class="headerlink" title="OpenLDAP应用点讲解"></a>OpenLDAP应用点讲解</h1><h2 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h2><p><a href="http://www.openldap.org/doc/admin24/" target="_blank" rel="noopener">http://www.openldap.org/doc/admin24/</a></p><h2 id="OpenLDAP部署及配置"><a href="#OpenLDAP部署及配置" class="headerlink" title="OpenLDAP部署及配置"></a>OpenLDAP部署及配置</h2><ul><li>常规安装方式</li><li>Docker安装方式，推荐使用<a href="https://github.com/osixia/docker-openldap" target="_blank" rel="noopener">osixia</a></li></ul><h2 id="监控及日常管理"><a href="#监控及日常管理" class="headerlink" title="监控及日常管理"></a>监控及日常管理</h2><ul><li>添加、删除、修改组及人员信息</li><li>定期监控OpenLDAP使用情况<br><img src="/archives/5724c435/03.png" alt=""><br><img src="/archives/5724c435/04.png" alt=""></li><li>TLS协议加密</li><li>主从架构、双主架构</li></ul><h2 id="Web化管理工具"><a href="#Web化管理工具" class="headerlink" title="Web化管理工具"></a>Web化管理工具</h2><ul><li>服务phpldapadmin<br><img src="/archives/5724c435/01.png" alt=""></li><li>自助密码找回及重置功能实现Self Service Password<br><img src="/archives/5724c435/02.png" alt=""></li><li>自研(一般实现账号、组增删改查、密码重置及日常统计信息即可)<br><img src="/archives/5724c435/05.png" alt=""></li></ul><h2 id="window客户端管理工具"><a href="#window客户端管理工具" class="headerlink" title="window客户端管理工具"></a>window客户端管理工具</h2><ul><li>Apache Directory Studio</li><li><a href="http://www.ldapadmin.org/download/ldapadmin.html" target="_blank" rel="noopener">LdapAdmin</a></li></ul><h2 id="用户分组划分问题"><a href="#用户分组划分问题" class="headerlink" title="用户分组划分问题"></a>用户分组划分问题</h2><ul><li>如果公司架构相对稳定可以将用户之间划分到预设的不同部门的LDAP组中，如果不固定，则添加到默认组，然后根据需要将用户添加到不同的组中</li></ul><h1 id="OpenLDAP与其他应用结合"><a href="#OpenLDAP与其他应用结合" class="headerlink" title="OpenLDAP与其他应用结合"></a>OpenLDAP与其他应用结合</h1><ul><li>源码管理：SVN、GitLab、Gogs、Phabricator</li><li>企业应用：Bug管理Jira、Wiki应用Conflunce</li><li>日志解决方案：GrayLog、ELK(付费功能)</li><li>远程办公应用：OpenVPN、L2TP</li><li>企业级文件共享：群晖NAS、Samba、vsftpd,proftpd</li><li>服务器权限管理：SSH、Kerberos、Jumpserver</li><li>BI数据分析方案：Redash</li><li>监控解决方案：Grafana,Zabbix,OpenFalcon</li><li>CI/CD：Jenkins</li><li>Web服务：Apache、Nginx</li><li>配置管理: Vault</li><li>其他自定义接入解决方案</li></ul><p>OpenLDAP应用非常广泛，还有很多很多，目前列举了中小企业常见的应用场景，其他就不一一列举了。</p><h1 id="OpenLDAP接入案例"><a href="#OpenLDAP接入案例" class="headerlink" title="OpenLDAP接入案例"></a>OpenLDAP接入案例</h1><ul><li><a href="http://www.mdslq.cn/archives/56a056be.html" target="_blank" rel="noopener">OpenLDAP之Confluence接入设置</a></li><li><a href="http://www.mdslq.cn/archives/ff02dc0f.html" target="_blank" rel="noopener">OpenLDAP之HashiCorp Vault接入配置</a></li></ul><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li><a href="http://www.openldap.org/" target="_blank" rel="noopener">OpenLDAP官网</a></li><li><a href="http://phpldapadmin.sourceforge.net/wiki/index.php/Main_Page" target="_blank" rel="noopener">phpLDAPadmin</a></li><li><a href="https://github.com/ltb-project" target="_blank" rel="noopener">Self Service Password</a></li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/5724c435.html">https://mds1455975151.github.io/archives/5724c435.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      OpenLDAP集中认证管理知识汇总
    
    </summary>
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/categories/DevOps/"/>
    
    
      <category term="OpenLDAP" scheme="https://mds1455975151.github.io/tags/OpenLDAP/"/>
    
      <category term="权限认证" scheme="https://mds1455975151.github.io/tags/%E6%9D%83%E9%99%90%E8%AE%A4%E8%AF%81/"/>
    
  </entry>
  
  <entry>
    <title>基于Aliyun+OSS+PostgreSQL+Redash+OpenLDAP部署业务数据分析平台</title>
    <link href="https://mds1455975151.github.io/archives/a136f7d4.html"/>
    <id>https://mds1455975151.github.io/archives/a136f7d4.html</id>
    <published>2019-10-27T02:59:45.000Z</published>
    <updated>2020-04-03T07:09:14.028Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>基于Aliyun OSS+PostgreSQL+Redash+OpenLDAP部署业务数据分析平台</p></blockquote><a id="more"></a><h1 id="项目概述"><a href="#项目概述" class="headerlink" title="项目概述"></a>项目概述</h1><p>利用开源产品迅速实现业务数据存储、分析、展示的业务平台。<br>redash 是一款开源的 BI 工具，提供了基于web的数据库查询和数据可视化功能。<br><img src="/archives/a136f7d4/01.gif" alt=""><br>支持多种数据源：<br><img src="/archives/a136f7d4/05.png" alt=""></p><h1 id="实现功能列表"><a href="#实现功能列表" class="headerlink" title="实现功能列表"></a>实现功能列表</h1><ul><li>使用CentOS 7.x Docker-Compose方式快速部署Redash</li><li>Redash基于Let’s encrypt 免费SSL证书实现HTTPS安全访问</li><li>配合OpenLDAP做统一账号权限管理</li><li>配置邮件通知、分析告警功能</li><li>Python+Shell实现OSS数据分流压缩上传及定时入库</li><li>截止到文章发布前Aliyun OSS数据存储1.2T,PostgreSQL数据量存储1.74T</li></ul><h1 id="项目展示"><a href="#项目展示" class="headerlink" title="项目展示"></a>项目展示</h1><p><img src="/archives/a136f7d4/01.png" alt=""><br><img src="/archives/a136f7d4/02.png" alt=""><br><img src="/archives/a136f7d4/03.png" alt=""><br><img src="/archives/a136f7d4/04.png" alt=""><br><img src="/archives/a136f7d4/01.webp" alt=""></p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li><a href="https://redash.io/" target="_blank" rel="noopener">redash 官网</a></li><li><a href="https://help.aliyun.com/product/31815.html" target="_blank" rel="noopener">Aliyun OSS</a></li><li><a href="https://help.aliyun.com/product/35364.html" target="_blank" rel="noopener">Aliyu PostgreSQL</a></li><li><a href="https://help.aliyun.com/document_detail/35457.html" target="_blank" rel="noopener">Aliyu PostgreSQL OSS外部表使用</a></li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/a136f7d4.html">https://mds1455975151.github.io/archives/a136f7d4.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      基于Aliyun OSS+PostgreSQL+Redash+OpenLDAP部署业务数据分析平台
    
    </summary>
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/categories/DevOps/"/>
    
    
      <category term="OpenLDAP" scheme="https://mds1455975151.github.io/tags/OpenLDAP/"/>
    
      <category term="docker-compose" scheme="https://mds1455975151.github.io/tags/docker-compose/"/>
    
      <category term="Redash" scheme="https://mds1455975151.github.io/tags/Redash/"/>
    
      <category term="PostgreSQL" scheme="https://mds1455975151.github.io/tags/PostgreSQL/"/>
    
      <category term="Aliyun OSS" scheme="https://mds1455975151.github.io/tags/Aliyun-OSS/"/>
    
  </entry>
  
  <entry>
    <title>Jira实现钉钉群任务信息通知</title>
    <link href="https://mds1455975151.github.io/archives/739486c6.html"/>
    <id>https://mds1455975151.github.io/archives/739486c6.html</id>
    <published>2019-09-12T10:00:01.000Z</published>
    <updated>2020-04-03T07:09:13.880Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>Jira实现钉钉群任务信息通知</p></blockquote><a id="more"></a><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>设置Jira任务信息通知到钉钉工作群，及时通知给相关人员。</p><h1 id="添加钉钉机器人生成token"><a href="#添加钉钉机器人生成token" class="headerlink" title="添加钉钉机器人生成token"></a>添加钉钉机器人生成token</h1><p>群设置–&gt;智能群助手–&gt;添加更多–&gt;添加机器人–&gt;现在Jira–&gt;添加–&gt;设置机器人名字–&gt;点击完成，记录webhook地址–&gt;点击完成</p><blockquote><p>第一次设置，可以在最后一步查看参考设置说明</p></blockquote><h1 id="Jira设置"><a href="#Jira设置" class="headerlink" title="Jira设置"></a>Jira设置</h1><p>Jira版本： v7.8.1</p><p>系统–网络钩子–创建网络钩子–&gt;设置webhook名称等相关信息–&gt;选择通知事件–&gt;点击完成，案例如下。</p><p><img src="/archives/739486c6/01.png" alt=""></p><h1 id="验证设置效果"><a href="#验证设置效果" class="headerlink" title="验证设置效果"></a>验证设置效果</h1><p><img src="/archives/739486c6/02.png" alt=""></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/739486c6.html">https://mds1455975151.github.io/archives/739486c6.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      Jira实现钉钉群任务信息通知
    
    </summary>
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/categories/DevOps/"/>
    
    
      <category term="Jira" scheme="https://mds1455975151.github.io/tags/Jira/"/>
    
      <category term="dingding" scheme="https://mds1455975151.github.io/tags/dingding/"/>
    
      <category term="钉钉" scheme="https://mds1455975151.github.io/tags/%E9%92%89%E9%92%89/"/>
    
      <category term="高效办公" scheme="https://mds1455975151.github.io/tags/%E9%AB%98%E6%95%88%E5%8A%9E%E5%85%AC/"/>
    
  </entry>
  
  <entry>
    <title>ELK实践分享</title>
    <link href="https://mds1455975151.github.io/archives/628093c8.html"/>
    <id>https://mds1455975151.github.io/archives/628093c8.html</id>
    <published>2019-09-03T02:15:35.000Z</published>
    <updated>2020-04-03T07:09:13.774Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:37 GMT+0800 (GMT+08:00) --><blockquote><p>ELK实践分享</p></blockquote><a id="more"></a><h1 id="ELK简介"><a href="#ELK简介" class="headerlink" title="ELK简介"></a>ELK简介</h1><p>ELK是三个开源项目的首字母缩写：Elasticsearch，Logstash和Kibana。Elasticsearch是一个搜索和分析引擎。Logstash是一个服务器端数据处理管道，它同时从多个源中提取数据，对其进行转换，然后将其发送到像Elasticsearch这样的存储。Kibana允许用户使用Elasticsearch中的图表和图形来可视化数据。</p><h1 id="实践说明"><a href="#实践说明" class="headerlink" title="实践说明"></a>实践说明</h1><ul><li>服务器使用两台4核8GB阿里云主机<ul><li>10.2.1.200 Filebeat、Logstash、Elasticsearch、Kibana</li><li>10.2.1.201 Kafka</li></ul></li><li>所有应用部署使用ansible-playbook方式实现</li></ul><h1 id="软件版本"><a href="#软件版本" class="headerlink" title="软件版本"></a>软件版本</h1><ul><li>filebeat-7.3.1-1.x86_64</li><li>kafka_2.11-2.1.1</li><li>elasticsearch-7.3.1-1.x86_64</li><li>logstash-7.3.1-1.noarch</li><li>kibana-7.3.1-1.x86_64</li></ul><h1 id="实践架构"><a href="#实践架构" class="headerlink" title="实践架构"></a>实践架构</h1><ul><li>Filebeat–&gt;Kafka–&gt;Logstash–&gt;Elasticsearch–&gt;Kibana(使用X-Pack保障集群安全)</li></ul><h1 id="Elasticsearch部署"><a href="#Elasticsearch部署" class="headerlink" title="Elasticsearch部署"></a>Elasticsearch部署</h1><h2 id="安装JDK及设置环境变量"><a href="#安装JDK及设置环境变量" class="headerlink" title="安装JDK及设置环境变量"></a>安装JDK及设置环境变量</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># rpm -ivh jdk-8u161-linux-x64.rpm</span><br><span class="line"># cat&gt;&gt;/etc/profile&lt;&lt;EOF</span><br><span class="line"></span><br><span class="line"># JAVA bin PATH setup</span><br><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_161/</span><br><span class="line">export CLASSPATH=.:\$JAVA_HOME/jre/lib/rt.jar:\$JAVA_HOME/lib/dt.jar:\$JAVA_HOME/lib/tools.jar</span><br><span class="line">export PATH=\$PATH:\$JAVA_HOME/bin</span><br><span class="line">EOF</span><br><span class="line">source /etc/profile</span><br><span class="line"></span><br><span class="line"># cat&gt;&gt;~/.bashrc&lt;&lt;EOF</span><br><span class="line"></span><br><span class="line"># JAVA bin PATH setup</span><br><span class="line">export JAVA_HOME=/usr/java/jdk1.8.0_161/</span><br><span class="line">export CLASSPATH=.:\$JAVA_HOME/jre/lib/rt.jar:\$JAVA_HOME/lib/dt.jar:\$JAVA_HOME/lib/tools.jar</span><br><span class="line">export PATH=\$PATH:\$JAVA_HOME/bin</span><br><span class="line">EOF</span><br><span class="line">source ~/.bashrc</span><br></pre></td></tr></table></figure><h2 id="Elasticsearch安装"><a href="#Elasticsearch安装" class="headerlink" title="Elasticsearch安装"></a>Elasticsearch安装</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># rpm -ivh elasticsearch-7.3.1-x86_64.rpm</span><br><span class="line"># grep -vE &quot;^#|^$&quot; /etc/elasticsearch/elasticsearch.yml</span><br><span class="line">cluster.name: version_test</span><br><span class="line">path.data:</span><br><span class="line">  - /data0/elasticsearch/data</span><br><span class="line">path.logs: /data0/elasticsearch/logs</span><br><span class="line">network.host: 10.2.1.201</span><br><span class="line">http.port: 9200</span><br><span class="line">discovery.seed_hosts:</span><br><span class="line">  - 10.2.1.201</span><br><span class="line">cluster.initial_master_nodes: [&apos;10.2.1.201&apos;]</span><br><span class="line">bootstrap.system_call_filter: false</span><br><span class="line">node.attr.zone: cn-hangzhou</span><br><span class="line">node.attr.box_type: hot</span><br><span class="line">path.repo:</span><br><span class="line">  - &quot;/es-ossfs/snapshots&quot;</span><br><span class="line">http.max_initial_line_length: 8k</span><br><span class="line">http.max_header_size: 16k</span><br><span class="line">xpack.security.enabled: true</span><br><span class="line">xpack.security.transport.ssl.enabled: true</span><br><span class="line">xpack.security.transport.ssl.verification_mode: certificate</span><br><span class="line">xpack.security.transport.ssl.keystore.path: elastic-certificates.p12</span><br><span class="line">xpack.security.transport.ssl.truststore.path: elastic-certificates.p12</span><br><span class="line">xpack.monitoring.enabled: true</span><br><span class="line"></span><br><span class="line"># systemctl start elasticsearch.service</span><br><span class="line"># systemctl enable elasticsearch.service</span><br></pre></td></tr></table></figure><h2 id="配置TLS和身份验证"><a href="#配置TLS和身份验证" class="headerlink" title="配置TLS和身份验证"></a>配置TLS和身份验证</h2><p>第一件事是生成证书，通过这些证书便能允许节点安全地通行。我们这里使用elasticsearch-certutil命令。</p><ul><li>步骤1：Elasticsearch master node配置TLS<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># /usr/share/elasticsearch/bin/elasticsearch-certutil --help</span><br><span class="line"># /usr/share/elasticsearch/bin/elasticsearch-certutil cert -out config/elastic-certificates.p12 -pass &quot;&quot;</span><br><span class="line"># cd /etc/elasticsearch &amp;&amp; cp /usr/share/elasticsearch/config/elastic-certificates.p12 .</span><br><span class="line"># vim /etc/elasticsearch/elasticsearch.yml</span><br><span class="line">xpack.security.enabled: true</span><br><span class="line">xpack.security.transport.ssl.enabled: true</span><br><span class="line">xpack.security.transport.ssl.verification_mode: certificate</span><br><span class="line">xpack.security.transport.ssl.keystore.path: elastic-certificates.p12</span><br><span class="line">xpack.security.transport.ssl.truststore.path: elastic-certificates.p12</span><br></pre></td></tr></table></figure></li></ul><blockquote><p>修改配置文件后，便可以重启主节点</p></blockquote><ul><li>步骤2：Elasticsearch集群密码<blockquote><p>主节点重启后，便可以为集群设置密码了。 使用命令/usr/share/elasticsearch/bin/elasticsearch-setup-passwords auto生成随机密码或使用/usr/share/elasticsearch/bin/elasticsearch-setup-passwords interactive命令手动定义密码。记录这些密码。</p></blockquote></li></ul><h1 id="Kibana部署"><a href="#Kibana部署" class="headerlink" title="Kibana部署"></a>Kibana部署</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"># rpm -ivh kibana-7.3.1-x86_64.rpm</span><br><span class="line"># grep -vE &quot;^$|^#&quot; /etc/kibana/kibana.yml</span><br><span class="line">server.host: &quot;10.2.1.201&quot;</span><br><span class="line">elasticsearch.hosts: [&quot;http://10.2.1.201:9200&quot;]</span><br><span class="line">elasticsearch.username: &quot;elastic&quot;</span><br><span class="line">elasticsearch.password: &quot;xxx&quot;</span><br><span class="line">xpack.monitoring.enabled: true</span><br><span class="line"># systemctl start kibana.service</span><br><span class="line"># systemctl enable kibana.service</span><br></pre></td></tr></table></figure><p><img src="/archives/628093c8/01.png" alt=""><br><img src="/archives/628093c8/02.png" alt=""></p><h1 id="kafka部署-单节点"><a href="#kafka部署-单节点" class="headerlink" title="kafka部署(单节点)"></a>kafka部署(单节点)</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># tar -zxf kafka_2.11-2.1.1.tgz /usr/local/</span><br><span class="line"># ln -s /usr/local/kafka_2.11-2.1.1 kafka</span><br><span class="line"># grep -vE &quot;^$|^#&quot; server.properties</span><br><span class="line">broker.id=0</span><br><span class="line">listeners=PLAINTEXT://10.2.1.200:9092</span><br><span class="line">num.network.threads=3</span><br><span class="line">num.io.threads=8</span><br><span class="line">socket.send.buffer.bytes=102400</span><br><span class="line">socket.receive.buffer.bytes=102400</span><br><span class="line">socket.request.max.bytes=104857600</span><br><span class="line">log.dirs=/tmp/kafka-logs</span><br><span class="line">num.partitions=1</span><br><span class="line">num.recovery.threads.per.data.dir=1</span><br><span class="line">offsets.topic.replication.factor=1</span><br><span class="line">transaction.state.log.replication.factor=1</span><br><span class="line">transaction.state.log.min.isr=1</span><br><span class="line">log.retention.hours=168</span><br><span class="line">log.segment.bytes=1073741824</span><br><span class="line">log.retention.check.interval.ms=300000</span><br><span class="line">zookeeper.connect=localhost:2181</span><br><span class="line">zookeeper.connection.timeout.ms=6000</span><br><span class="line">group.initial.rebalance.delay.ms=0</span><br><span class="line"># /usr/local/kafka/bin/zookeeper-server-start.sh -daemon /usr/local/kafka/config/zookeeper.properties</span><br><span class="line"># /usr/local/kafka/bin/kafka-server-start.sh -daemon /usr/local/kafka/config/server.properties</span><br><span class="line"># netstat -tunlp|grep java        </span><br><span class="line">tcp        0      0 10.2.1.200:9092         0.0.0.0:*               LISTEN      11427/java          </span><br><span class="line">tcp        0      0 0.0.0.0:2181            0.0.0.0:*               LISTEN      10716/java</span><br></pre></td></tr></table></figure><h1 id="filebeat部署"><a href="#filebeat部署" class="headerlink" title="filebeat部署"></a>filebeat部署</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"># rpm -ivh filebeat-7.3.1-x86_64.rpm</span><br><span class="line"># grep -vE &quot;^$|^#&quot; /etc/filebeat/filebeat.yml</span><br><span class="line">filebeat.inputs:</span><br><span class="line">- type: log</span><br><span class="line">  enabled: true</span><br><span class="line">  paths:</span><br><span class="line">    - /var/log/*.log</span><br><span class="line">filebeat.config.modules:</span><br><span class="line">  path: $&#123;path.config&#125;/modules.d/*.yml</span><br><span class="line">  reload.enabled: true</span><br><span class="line">  reload.period: 10s</span><br><span class="line">setup.template.settings:</span><br><span class="line">  index.number_of_shards: 1</span><br><span class="line">  #index.codec: best_compression</span><br><span class="line">  #_source.enabled: false</span><br><span class="line">setup.kibana:</span><br><span class="line">  host: &quot;10.2.1.201:5601&quot;</span><br><span class="line">  # Kibana Space ID</span><br><span class="line">  # ID of the Kibana Space into which the dashboards should be loaded. By default,</span><br><span class="line">  # the Default Space will be used.</span><br><span class="line">  #space.id:</span><br><span class="line">output.kafka:</span><br><span class="line">  enabled: true</span><br><span class="line">  hosts: [&quot;10.2.1.200:9092&quot;]</span><br><span class="line">  topic: &apos;logs&apos;</span><br><span class="line">  partition.round_robin:</span><br><span class="line">    reachable_only: false</span><br><span class="line"></span><br><span class="line">  required_acks: 1</span><br><span class="line">  compression: gzip</span><br><span class="line">  max_message_bytes: 1000000</span><br><span class="line">processors:</span><br><span class="line">  - add_host_metadata: ~</span><br><span class="line">  - add_cloud_metadata: ~</span><br><span class="line">logging.level: info</span><br><span class="line">logging.to_files: true</span><br><span class="line">logging.files:</span><br><span class="line">  path: /var/log/filebeat</span><br><span class="line">  name: filebeat</span><br><span class="line">  keepfiles: 7</span><br><span class="line">  permissions: 0644</span><br></pre></td></tr></table></figure><h1 id="Logstash部署"><a href="#Logstash部署" class="headerlink" title="Logstash部署"></a>Logstash部署</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># rpm -ivh logstash-7.3.1.rpm</span><br><span class="line"># grep -vE &quot;^$|^#&quot; /etc/logstash/logstash.yml</span><br><span class="line">path.data: /var/lib/logstash</span><br><span class="line">http.host: &quot;10.2.1.201&quot;</span><br><span class="line">path.logs: /var/log/logstash                               </span><br><span class="line"># grep -vE &quot;^$|^#&quot; /etc/logstash/conf.d/logstash-input-kafka.conf</span><br><span class="line">input &#123;</span><br><span class="line">  kafka &#123;</span><br><span class="line">    bootstrap_servers =&gt; [&quot;10.2.1.200:9092&quot;]</span><br><span class="line">    auto_offset_reset =&gt; &quot;latest&quot;</span><br><span class="line">    consumer_threads =&gt; 5</span><br><span class="line">    topics =&gt; [&quot;logs&quot;]</span><br><span class="line">    decorate_events =&gt; true</span><br><span class="line">    codec =&gt; &quot;json&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">output &#123;</span><br><span class="line">  elasticsearch &#123;</span><br><span class="line">    hosts =&gt; [&quot;http://10.2.1.201:9200&quot;]</span><br><span class="line">    index =&gt; &quot;%&#123;[@metadata][beat]&#125;-%&#123;[@metadata][version]&#125;-%&#123;+YYYY.MM.dd&#125;&quot;</span><br><span class="line">    user =&gt; &quot;elastic&quot;</span><br><span class="line">    password =&gt; &quot;xxx&quot;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="验证中间环节工作正常"><a href="#验证中间环节工作正常" class="headerlink" title="验证中间环节工作正常"></a>验证中间环节工作正常</h1><h2 id="filebeat到kafka通信验证"><a href="#filebeat到kafka通信验证" class="headerlink" title="filebeat到kafka通信验证"></a>filebeat到kafka通信验证</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># /usr/local/kafka/bin/kafka-topics.sh --list --zookeeper localhost:2181    确保存在topic名为logs</span><br><span class="line">__consumer_offsets</span><br><span class="line">logs</span><br><span class="line">test</span><br></pre></td></tr></table></figure><h2 id="kafka到logstash"><a href="#kafka到logstash" class="headerlink" title="kafka到logstash"></a>kafka到logstash</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># /usr/local/kafka/bin/kafka-run-class.sh kafka.tools.GetOffsetShell --broker-list 10.2.1.200:9092 --topic logs --time -1</span><br><span class="line">logs:0:10022</span><br><span class="line"># /usr/local/kafka/bin/kafka-run-class.sh kafka.tools.GetOffsetShell --broker-list 10.2.1.200:9092 --topic logs --time -2</span><br><span class="line">logs:0:0</span><br></pre></td></tr></table></figure><h2 id="端到端验证日志"><a href="#端到端验证日志" class="headerlink" title="端到端验证日志"></a>端到端验证日志</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">在安装filebeat的主机上执行三次生成三条日志</span><br><span class="line"># echo &quot;111&quot; &gt;&gt; /var/log/yum.log</span><br><span class="line"></span><br><span class="line">验证kafka消费记录</span><br><span class="line"># /usr/local/kafka/bin/kafka-run-class.sh kafka.tools.GetOffsetShell --broker-list 10.2.1.200:9092 --topic logs --time -1</span><br><span class="line">logs:0:10025</span><br><span class="line"># /usr/local/kafka/bin/kafka-run-class.sh kafka.tools.GetOffsetShell --broker-list 10.2.1.200:9092 --topic logs --time -2</span><br><span class="line">logs:0:0</span><br></pre></td></tr></table></figure><p>kibana验证日志数据<br><img src="/archives/628093c8/03.png" alt=""></p><h1 id="关于X-Pack几点说明"><a href="#关于X-Pack几点说明" class="headerlink" title="关于X-Pack几点说明"></a>关于X-Pack几点说明</h1><ul><li>在7.x版本中X-Pack已经内置，无需单独安装</li><li>启用X-Pack后需要掌握Kibana中配置基于角色的访问控制(RBAC)</li><li>启用X-Pack后使用API的方法<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># curl -u elastic:xxx &quot;http://10.2.1.201:9200/_cluster/health?pretty&quot;  # 无交互调用API</span><br><span class="line"># curl -X GET -u elastic &apos;10.2.1.201:9200/_xpack/security/role&apos;        # 交互式调用API</span><br></pre></td></tr></table></figure></li></ul><h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><ul><li>Elasticsearch权限解决方案<ul><li>1、X-Pack</li><li>2、SearchGuard插件</li></ul></li></ul><p>ELK暂时介绍到这里，有任何问题，可以留言。</p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/628093c8.html">https://mds1455975151.github.io/archives/628093c8.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      ELK实践分享
    
    </summary>
    
      <category term="ELK" scheme="https://mds1455975151.github.io/categories/ELK/"/>
    
    
      <category term="Elasticsearch" scheme="https://mds1455975151.github.io/tags/Elasticsearch/"/>
    
      <category term="ELK" scheme="https://mds1455975151.github.io/tags/ELK/"/>
    
      <category term="X-Pack" scheme="https://mds1455975151.github.io/tags/X-Pack/"/>
    
  </entry>
  
  <entry>
    <title>树莓派之使用FRP实现内网穿透</title>
    <link href="https://mds1455975151.github.io/archives/4b72728b.html"/>
    <id>https://mds1455975151.github.io/archives/4b72728b.html</id>
    <published>2019-05-13T06:52:34.000Z</published>
    <updated>2020-04-03T07:09:14.073Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><p>&gt;</p><a id="more"></a><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/4b72728b.html">https://mds1455975151.github.io/archives/4b72728b.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      &lt;!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --&gt;&lt;p&gt;&amp;gt;&lt;/p&gt;
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>树莓派之树莓派系统安装</title>
    <link href="https://mds1455975151.github.io/archives/1b81c224.html"/>
    <id>https://mds1455975151.github.io/archives/1b81c224.html</id>
    <published>2019-05-12T10:51:36.000Z</published>
    <updated>2020-04-03T07:09:14.073Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>树莓派系统安装</p></blockquote><a id="more"></a><h1 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h1><p>树莓派(是为学习计算机编程教育而设计)，只有信用卡大小的微型电脑，其系统基于Linux。随着Windows 10 IoT的发布，我们也将可以用上运行Windows的树莓派。2014年刚知道有树莓派的时候好奇买了一块，型号：Raspberry Pi Model B Rev 2。当时安装完系统玩了几天，就丢一边吃灰去了，今天闲来无事，将其重新安装了以下，特此记录。</p><h1 id="树莓派能做什么？"><a href="#树莓派能做什么？" class="headerlink" title="树莓派能做什么？"></a>树莓派能做什么？</h1><p>功能强大，只要有创造力，一切皆有可能，折腾起来吧。目前的一些应用列表<a href="http://shumeipai.nxez.com/what-raspi-used-for" target="_blank" rel="noopener">参考</a>。</p><h1 id="所需工具"><a href="#所需工具" class="headerlink" title="所需工具"></a>所需工具</h1><h2 id="硬件"><a href="#硬件" class="headerlink" title="硬件"></a>硬件</h2><ul><li>PC一台</li><li>树莓派一台</li><li>TF(Micro SD)卡一个8GB(建议买32GB以上的高速卡)</li><li>读卡器一个<h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2></li><li>官网镜像</li><li>SD Card Formatter(格式化TF卡)</li><li>Win32DiskImager(镜像写入工具)<h1 id="操作记录"><a href="#操作记录" class="headerlink" title="操作记录"></a>操作记录</h1><h2 id="树莓派系统下载"><a href="#树莓派系统下载" class="headerlink" title="树莓派系统下载"></a>树莓派系统下载</h2>系统下载地址：<a href="https://www.raspberrypi.org/downloads/" target="_blank" rel="noopener">https://www.raspberrypi.org/downloads/</a><br>树莓派除了支持该系统外，还支持一些第三方系统，大家可以根据需求更换适合自己的操作系统镜像。<br><img src="/archives/1b81c224/01.png" alt=""></li></ul><p>可用的第三方系统<br><img src="/archives/1b81c224/02.png" alt=""></p><h2 id="格式化TF卡"><a href="#格式化TF卡" class="headerlink" title="格式化TF卡"></a>格式化TF卡</h2><p>工具下载地址：<a href="https://www.sdcard.org/downloads/formatter/eula_windows/index.html" target="_blank" rel="noopener">SD Card Formatter</a><br><img src="/archives/1b81c224/03.png" alt=""></p><h2 id="将下载好的系统镜像写入TF卡"><a href="#将下载好的系统镜像写入TF卡" class="headerlink" title="将下载好的系统镜像写入TF卡"></a>将下载好的系统镜像写入TF卡</h2><p><img src="/archives/1b81c224/04.png" alt=""></p><h2 id="自定义配置"><a href="#自定义配置" class="headerlink" title="自定义配置"></a>自定义配置</h2><ul><li><p>设置开启SSH服务</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># 在TF卡根目录下添加一个名为SSH的空文件</span><br></pre></td></tr></table></figure></li><li><p>设置HDMI配置(不设置的话显示器可能显示无信号导致黑屏)</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># 取消以下两项注释</span><br><span class="line">hdmi_force_hotplug=1       # 启用HDMI热插拔功能</span><br><span class="line">config_hdmi_boost=4        # 加强HDMI信号</span><br></pre></td></tr></table></figure></li></ul><h2 id="插上显示器、键盘、鼠标、通电"><a href="#插上显示器、键盘、鼠标、通电" class="headerlink" title="插上显示器、键盘、鼠标、通电"></a>插上显示器、键盘、鼠标、通电</h2><p>略</p><h2 id="获取树莓派IP地址"><a href="#获取树莓派IP地址" class="headerlink" title="获取树莓派IP地址"></a>获取树莓派IP地址</h2><ul><li>有显示器的情况<br>使用xshell、SecreCRT等终端工具登录系统后，使用ifconfig命令查看，默认账号：pi 密码：raspberrypi<br><img src="/archives/1b81c224/05.png" alt=""></li><li>无显示器的情况<br>方法1：通过查看路由器界面获取IP地址<br>一般后台显示树莓派的名字为raspberrypi，例如：我使用openwrt路由器web界面显示如下<br><img src="/archives/1b81c224/06.png" alt=""><br>方法2：使用局域网扫描工具</li></ul><blockquote><p>最佳实践：设置路由器绑定MAC地址，使树莓派使用固定IP地址</p></blockquote><h2 id="开启VNC便于后期不使用显示器连接pi"><a href="#开启VNC便于后期不使用显示器连接pi" class="headerlink" title="开启VNC便于后期不使用显示器连接pi"></a>开启VNC便于后期不使用显示器连接pi</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pi@raspberrypi:~ $ sudo raspi-config</span><br></pre></td></tr></table></figure><p><img src="/archives/1b81c224/07.png" alt=""><br><img src="/archives/1b81c224/08.png" alt=""><br><img src="/archives/1b81c224/09.png" alt=""><br><img src="/archives/1b81c224/10.png" alt=""></p><h2 id="更换国内软件源"><a href="#更换国内软件源" class="headerlink" title="更换国内软件源"></a>更换国内软件源</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo sed -i.bak &apos;s@http://raspbian.raspberrypi.org/raspbian/@http://mirrors.ustc.edu.cn/raspbian/raspbian/@g&apos; /etc/apt/sources.list</span><br><span class="line">sudo sed -i.bak &apos;s@http://archive.raspberrypi.org/debian/@http://mirrors.ustc.edu.cn/archive.raspberrypi.org/debian/@g&apos; /etc/apt/sources.list.d/raspi.list</span><br><span class="line">sudo apt-get update</span><br></pre></td></tr></table></figure><h2 id="为了便于查看树莓派运行状况可以安装pi-dashboard工具"><a href="#为了便于查看树莓派运行状况可以安装pi-dashboard工具" class="headerlink" title="为了便于查看树莓派运行状况可以安装pi-dashboard工具"></a>为了便于查看树莓派运行状况可以安装pi-dashboard工具</h2><p>详细安装过程参考后续博客(待补充)</p><h1 id="效果展示"><a href="#效果展示" class="headerlink" title="效果展示"></a>效果展示</h1><p><img src="/archives/1b81c224/11.png" alt=""><br><img src="/archives/1b81c224/12.png" alt=""></p><h1 id="总结及后续"><a href="#总结及后续" class="headerlink" title="总结及后续"></a>总结及后续</h1><p>以上是树莓派的基本安装及配置过程，目前树莓派已经到3b+版本，后续可能会剁手在买一块，玩玩树莓派的一些集群功能，再分享给大家。</p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li><a href="https://www.raspberrypi.org/" target="_blank" rel="noopener">树莓派官网</a></li><li><a href="https://github.com/spoonysonny/pi-dashboard" target="_blank" rel="noopener">pi-dashboard</a></li><li><a href="http://shumeipai.nxez.com/" target="_blank" rel="noopener">树莓派实验室</a></li><li><a href="https://elinux.org/R-Pi_Troubleshooting" target="_blank" rel="noopener">R-Pi_Troubleshooting</a></li><li><a href="https://www.jianshu.com/p/c022c6f28c3a" target="_blank" rel="noopener">树莓派用HDMI连接电视显示”无信号”问题</a></li><li><a href="https://www.jianshu.com/p/654ee08d2b3a" target="_blank" rel="noopener">树莓派开启SSH的N种方法</a></li><li><a href="https://www.jianshu.com/p/eeebc735514b" target="_blank" rel="noopener">树莓派无法开机？</a></li><li><a href="http://shumeipai.nxez.com/2018/08/31/raspberry-pi-vnc-viewer-configuration-tutorial.html" target="_blank" rel="noopener">树莓派VNC Viewer远程桌面配置教程</a></li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/1b81c224.html">https://mds1455975151.github.io/archives/1b81c224.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      树莓派系统安装
    
    </summary>
    
      <category term="树莓派" scheme="https://mds1455975151.github.io/categories/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
    
      <category term="树莓派" scheme="https://mds1455975151.github.io/tags/%E6%A0%91%E8%8E%93%E6%B4%BE/"/>
    
      <category term="Raspberry Pi" scheme="https://mds1455975151.github.io/tags/Raspberry-Pi/"/>
    
  </entry>
  
  <entry>
    <title>福利贴01:免费FRP内网穿透工具</title>
    <link href="https://mds1455975151.github.io/archives/926ff624.html"/>
    <id>https://mds1455975151.github.io/archives/926ff624.html</id>
    <published>2019-04-26T02:05:19.000Z</published>
    <updated>2020-04-03T07:09:14.097Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>福利贴01:免费FRP内网穿透工具</p></blockquote><a id="more"></a><p><a href="https://www.freefrp.xyz:444/" target="_blank" rel="noopener">https://www.freefrp.xyz:444/</a></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/926ff624.html">https://mds1455975151.github.io/archives/926ff624.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      福利贴01:免费FRP内网穿透工具
    
    </summary>
    
      <category term="福利贴" scheme="https://mds1455975151.github.io/categories/%E7%A6%8F%E5%88%A9%E8%B4%B4/"/>
    
    
      <category term="福利贴" scheme="https://mds1455975151.github.io/tags/%E7%A6%8F%E5%88%A9%E8%B4%B4/"/>
    
      <category term="FRP" scheme="https://mds1455975151.github.io/tags/FRP/"/>
    
      <category term="内网穿透" scheme="https://mds1455975151.github.io/tags/%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/"/>
    
      <category term="无公网IP" scheme="https://mds1455975151.github.io/tags/%E6%97%A0%E5%85%AC%E7%BD%91IP/"/>
    
      <category term="花生壳" scheme="https://mds1455975151.github.io/tags/%E8%8A%B1%E7%94%9F%E5%A3%B3/"/>
    
      <category term="ngrok" scheme="https://mds1455975151.github.io/tags/ngrok/"/>
    
  </entry>
  
  <entry>
    <title>电影2019</title>
    <link href="https://mds1455975151.github.io/archives/2a14730.html"/>
    <id>https://mds1455975151.github.io/archives/2a14730.html</id>
    <published>2019-02-16T04:57:29.000Z</published>
    <updated>2020-04-03T07:09:14.096Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><p>&gt;</p><a id="more"></a><h1 id="电影"><a href="#电影" class="headerlink" title="电影"></a>电影</h1><ul><li><del>无双</del></li><li><del>天劫逃生</del></li><li><del>星际穿越</del></li><li><del>罪爱</del></li><li><del>脱缰之马</del></li><li><del>偷心女盗</del></li><li><del>黑衣人：全球追缉</del></li><li><del>寄生虫</del></li><li><del>移动城市：致命引擎</del></li><li><del>X战警：黑凤凰</del></li><li><strong>燃点</strong>(期待)</li><li><strong>窃听风暴</strong>(期待)</li><li><strong>无懈可击</strong>(期待)</li><li><strong>一切为了她</strong>(期待)</li><li><strong>勇敢的人</strong>(期待)</li><li><strong>四兄弟</strong>(期待)</li><li><strong>超级礼物 超级人生</strong>(期待)</li><li><strong>赌王之王</strong>(期待)</li><li><strong>重生男人</strong>(期待)</li><li><strong>神鬼奇谋</strong>(期待)</li><li>战栗空间</li><li><strong>丑闻</strong>韩国</li><li><strong>门锁</strong>韩国</li><li><strong>浪潮</strong></li></ul><h1 id="动漫"><a href="#动漫" class="headerlink" title="动漫"></a>动漫</h1><ul><li><strong>风语咒</strong></li><li><strong>精灵旅社3：疯狂假期</strong></li></ul><h1 id="电视剧"><a href="#电视剧" class="headerlink" title="电视剧"></a>电视剧</h1><ul><li><strong>怒晴湘西</strong></li><li><strong>长安十二时辰</strong></li><li><strong>日剧：轮到你了</strong></li><li><strong>风光大嫁</strong></li></ul><h1 id="美剧"><a href="#美剧" class="headerlink" title="美剧"></a>美剧</h1><ul><li><strong>盲点</strong></li><li><strong>黑洞频率</strong></li><li><strong>性教育第一季</strong></li></ul><h1 id="综艺节目"><a href="#综艺节目" class="headerlink" title="综艺节目"></a>综艺节目</h1><ul><li><strong>风味人间</strong></li><li><strong>风味原产地：潮汕</strong></li><li><strong>宵夜江湖</strong></li><li><strong>非正式会谈</strong></li></ul><h1 id="动漫-1"><a href="#动漫-1" class="headerlink" title="动漫"></a>动漫</h1><ul><li><strong>斗罗大陆</strong></li><li><strong>不良人3</strong></li><li><strong>哪吒 电影院</strong></li><li><strong>爱宠大机密2 电影院</strong></li></ul><h1 id="纪录片"><a href="#纪录片" class="headerlink" title="纪录片"></a>纪录片</h1><ul><li><del>美国工程-曹德旺</del></li></ul><h1 id="小说"><a href="#小说" class="headerlink" title="小说"></a>小说</h1><h1 id="音频-喜马拉雅"><a href="#音频-喜马拉雅" class="headerlink" title="音频(喜马拉雅)"></a>音频(喜马拉雅)</h1><ul><li>佛度有缘人</li><li>晓说</li><li>观复嘟嘟 马未都</li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/2a14730.html">https://mds1455975151.github.io/archives/2a14730.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      电影
    
    </summary>
    
      <category term="生活记录" scheme="https://mds1455975151.github.io/categories/%E7%94%9F%E6%B4%BB%E8%AE%B0%E5%BD%95/"/>
    
    
      <category term="电影" scheme="https://mds1455975151.github.io/tags/%E7%94%B5%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>游戏界名称解释(转)</title>
    <link href="https://mds1455975151.github.io/archives/78b6d9db.html"/>
    <id>https://mds1455975151.github.io/archives/78b6d9db.html</id>
    <published>2018-11-21T03:05:45.000Z</published>
    <updated>2020-04-03T07:09:14.086Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>游戏界名称解释</p></blockquote><a id="more"></a><p><img src="/archives/78b6d9db/01.jpg" alt=""></p><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/78b6d9db.html">https://mds1455975151.github.io/archives/78b6d9db.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      游戏界名称解释
    
    </summary>
    
      <category term="游戏" scheme="https://mds1455975151.github.io/categories/%E6%B8%B8%E6%88%8F/"/>
    
    
      <category term="游戏" scheme="https://mds1455975151.github.io/tags/%E6%B8%B8%E6%88%8F/"/>
    
      <category term="名称解释" scheme="https://mds1455975151.github.io/tags/%E5%90%8D%E7%A7%B0%E8%A7%A3%E9%87%8A/"/>
    
      <category term="独立游戏" scheme="https://mds1455975151.github.io/tags/%E7%8B%AC%E7%AB%8B%E6%B8%B8%E6%88%8F/"/>
    
      <category term="小众游戏" scheme="https://mds1455975151.github.io/tags/%E5%B0%8F%E4%BC%97%E6%B8%B8%E6%88%8F/"/>
    
      <category term="卡牌" scheme="https://mds1455975151.github.io/tags/%E5%8D%A1%E7%89%8C/"/>
    
      <category term="激活码测试" scheme="https://mds1455975151.github.io/tags/%E6%BF%80%E6%B4%BB%E7%A0%81%E6%B5%8B%E8%AF%95/"/>
    
      <category term="自研引擎" scheme="https://mds1455975151.github.io/tags/%E8%87%AA%E7%A0%94%E5%BC%95%E6%93%8E/"/>
    
  </entry>
  
  <entry>
    <title>搬瓦工VPS</title>
    <link href="https://mds1455975151.github.io/archives/d31e7a12.html"/>
    <id>https://mds1455975151.github.io/archives/d31e7a12.html</id>
    <published>2018-11-09T01:59:03.000Z</published>
    <updated>2020-04-03T07:09:14.072Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>搬瓦工VPS</p></blockquote><a id="more"></a><h1 id="搬瓦工VPS概述"><a href="#搬瓦工VPS概述" class="headerlink" title="搬瓦工VPS概述"></a>搬瓦工VPS概述</h1><p>搬瓦工(BandwagonHost) VPS，隶属于美国知名主机提供商IT7.NET公司旗下，由于其具有超低廉的价格和超高品质的服务，一直倍受中国用户好评。搬瓦工(BandwagonHost)VPS在中国市场占有率也是遥遥领先，对新手操作也十分友好，甚至是许多国人的第一台VPS。</p><p>2017年后，搬瓦工逐步从低端OpenVZ方案升级为了KVM方案，并针对中国用户非常关心的网络连接质量做了大量优化，先后推出 中国联通、电信直连优化方案和针对电信网络特别优化的CN2方案。中美间访问仅需 170ms。</p><blockquote><p>搬瓦工现已推出支付宝(Alipay)付款，无需信用卡即可轻松付款。</p></blockquote><h1 id="机房选择"><a href="#机房选择" class="headerlink" title="机房选择"></a>机房选择</h1><p>搬瓦工VPS主要有洛杉矶、凤凰城、荷兰、加拿大等9个全球机房<br>美国西海岸4个[首选]：洛杉矶QNET、洛杉矶MCOM、硅谷费利蒙(Fremont)、凤凰城(Phoenix)<br>其他4处为：纽约(New York)、佛罗里达(Florida)、加拿大温哥华、荷兰阿姆斯特丹</p><h1 id="方案选择"><a href="#方案选择" class="headerlink" title="方案选择"></a>方案选择</h1><h1 id="购买教程"><a href="#购买教程" class="headerlink" title="购买教程"></a>购买教程</h1><h1 id="FQA"><a href="#FQA" class="headerlink" title="FQA"></a>FQA</h1><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/d31e7a12.html">https://mds1455975151.github.io/archives/d31e7a12.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      搬瓦工VPS
    
    </summary>
    
      <category term="GFW" scheme="https://mds1455975151.github.io/categories/GFW/"/>
    
    
      <category term="翻墙" scheme="https://mds1455975151.github.io/tags/%E7%BF%BB%E5%A2%99/"/>
    
      <category term="搬瓦工" scheme="https://mds1455975151.github.io/tags/%E6%90%AC%E7%93%A6%E5%B7%A5/"/>
    
      <category term="VPS" scheme="https://mds1455975151.github.io/tags/VPS/"/>
    
      <category term="科学上网" scheme="https://mds1455975151.github.io/tags/%E7%A7%91%E5%AD%A6%E4%B8%8A%E7%BD%91/"/>
    
      <category term="KVM" scheme="https://mds1455975151.github.io/tags/KVM/"/>
    
      <category term="OpenVZ" scheme="https://mds1455975151.github.io/tags/OpenVZ/"/>
    
      <category term="BandwagonHost" scheme="https://mds1455975151.github.io/tags/BandwagonHost/"/>
    
  </entry>
  
  <entry>
    <title>Packer之Packer应用场景及常用概念介绍</title>
    <link href="https://mds1455975151.github.io/archives/22e81506.html"/>
    <id>https://mds1455975151.github.io/archives/22e81506.html</id>
    <published>2018-11-06T04:01:37.000Z</published>
    <updated>2020-04-03T07:09:13.955Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>Packer之Packer应用场景及常用概念介绍</p></blockquote><a id="more"></a><h1 id="Packer应用场景分析"><a href="#Packer应用场景分析" class="headerlink" title="Packer应用场景分析"></a>Packer应用场景分析</h1><p><img src="/archives/22e81506/03.png" alt=""></p><h2 id="场景1：自定义镜像"><a href="#场景1：自定义镜像" class="headerlink" title="场景1：自定义镜像"></a>场景1：自定义镜像</h2><p>用户需要定制特定版本的操作系统镜像，制作过程复杂，技术要求高，而且制作周期长。而使用packer，镜像的上传变的自动化，并且提供了一些可以参考的基础模板，用户只需要修改源ISO，就可以创建出指定版本的基础镜像，大大降低了镜像制作的门槛。<br><img src="/archives/22e81506/01.png" alt=""></p><h2 id="场景2：镜像更安全，制作更效率"><a href="#场景2：镜像更安全，制作更效率" class="headerlink" title="场景2：镜像更安全，制作更效率"></a>场景2：镜像更安全，制作更效率</h2><p>镜像市场中第三方镜像包含的内容是什么，对平台和用户都是不透明的。无法清晰的看到镜像中是否有安全隐患。为了确保安全，需要进行大量的安全扫描，一方面，使用发布第三方镜像的周期更长，另一方面，通过扫描二进制文件，很难完全避免安全风险。通过packer模板文件制作的镜像，我们可以清晰的看到脚本中执行的命令，相比二进制文件，安全扫描也更容易，同时也方便做镜像的版本管理，及多平台的镜像制作，提高镜像制作效率，不需要一遍遍的手动制作。</p><h2 id="场景3：弹性伸缩场景下，镜像的制作问题"><a href="#场景3：弹性伸缩场景下，镜像的制作问题" class="headerlink" title="场景3：弹性伸缩场景下，镜像的制作问题"></a>场景3：弹性伸缩场景下，镜像的制作问题</h2><p>在弹性伸缩场景中，镜像的生成是否方便高效起着重要的作用，当检测到工作负载达到阀值的时候，需要使用镜像来生成新的实例，当弹性伸缩的应用数量达到一定规模的时候，通过手工来创建镜像是难以接受的。特别是当需要升级应用时，如果使用传统的方式，直接在运行时实例上在线升级应用，一方面，在线升级的速度较慢，而且会影响在线用户的检验，另一方面，当出现错误的时候，回滚也比较困难，很容易形成较长时间的当机，而采用Packer,结合Jenkins和Terraform等工具，能够将应用的从代码到镜像升级，产生更新后实例的过程完全自动化。当Jenkins检测到有代码提交时，可以触发Packer根据模板使用更新后代码创建新的镜像，然后Jenkins触发Terraform来创建新ECS实例，将新实例加入伸缩组，并将旧实例移出伸缩组，这样就完成了应用的更新，当检测到新代码出现问题的时候，又可以将旧实例重新加入伸缩组而移除新实例来完成回滚。<br><img src="/archives/22e81506/02.png" alt=""></p><h1 id="Packer术语"><a href="#Packer术语" class="headerlink" title="Packer术语"></a>Packer术语</h1><ul><li><p>artifacts<br>单个构建的结果，通常是一组ID或文件来表示机器images。每个构建器都会生成一个工件。例如，对于Amazon EC2构建器，工件时一组AMI ID。对于VMware构建器，工件时包含已创建虚拟机的文件目录</p></li><li><p>builds<br>是一项单一任务，最终为单个平台生成images。多个构建并行运行。句子中的用法示例：packer构建生成了一个AMI来运行我们的web应用程序。或者packer现在正在为VMware，AWS或VirtualBox运行构建。</p></li><li><p>builders<br>是Packer组件，能够为单个平台创建机器images。构建器读取一些配置并使用它来运行和生成机器images。构建器作为构建的一部分被调用，以便创建实际的结果images。示例构建器包括VMware，AWS或VirtualBox。可以以插件的形式创建构建器并将其添加到Packer。</p></li><li><p>Commands<br>是Packer执行某项工作的程序的子命令。示例命令是build，它被调用为packer build。packer附带一组开箱即用的命令，以便定义其命令行界面。</p></li><li><p>post-Processors<br>Packer的组件，它获取构建器或其他后处理器的结果，并处理该组件以创建新工件。后处理器的示例是压缩以压缩工件，上传到上载工件等。</p></li><li><p>Provisioners<br>Packer的组件是在该机器被转换为静态映像之前在正在运行的机器中安装和配置软件的组件。他们执行使图像包含有用软件的主要工作。示例配置文件包括shell脚本，Chef，Puppet等。</p></li><li><p>Templates<br>是JSON文件，它通过配置Packer的各种组件来定义一个或多个构建。Packer能够读取模板并使用该信息并行创建多个机器映像。</p></li></ul><h1 id="模板文件案例讲解"><a href="#模板文件案例讲解" class="headerlink" title="模板文件案例讲解"></a>模板文件案例讲解</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># cat template.json</span><br><span class="line">&#123;</span><br><span class="line"> &quot;variables&quot;: &#123;</span><br><span class="line">       &quot;access_key&quot;: &quot;&#123;&#123;env `ALICLOUD_ACCESS_KEY`&#125;&#125;&quot;,</span><br><span class="line">       &quot;secret_key&quot;: &quot;&#123;&#123;env `ALICLOUD_SECRET_KEY`&#125;&#125;&quot;</span><br><span class="line">     &#125;,</span><br><span class="line"> &quot;builders&quot;: [&#123;</span><br><span class="line">       &quot;type&quot;:&quot;alicloud-ecs&quot;,</span><br><span class="line">       &quot;access_key&quot;:&quot;&#123;&#123;user `access_key`&#125;&#125;&quot;,</span><br><span class="line">       &quot;secret_key&quot;:&quot;&#123;&#123;user `secret_key`&#125;&#125;&quot;,</span><br><span class="line">       &quot;region&quot;:&quot;cn-beijing&quot;,</span><br><span class="line">       &quot;image_name&quot;:&quot;codepipe_demo&quot;,</span><br><span class="line">       &quot;source_image&quot;:&quot;ubuntu_16_0402_64_40G_alibase_20170711.vhd&quot;,</span><br><span class="line">       &quot;ssh_username&quot;:&quot;root&quot;,</span><br><span class="line">       &quot;instance_type&quot;:&quot;ecs.n1.medium&quot;,</span><br><span class="line">       &quot;io_optimized&quot;:&quot;true&quot;,</span><br><span class="line">       &quot;image_force_delete&quot;:&quot;true&quot;,</span><br><span class="line">       &quot;ssh_password&quot;:&quot;Test12345&quot;</span><br><span class="line">     &#125;],</span><br><span class="line"> &quot;provisioners&quot;: [&#123;</span><br><span class="line">      &quot;type&quot;: &quot;shell&quot;,</span><br><span class="line">      &quot;inline&quot;: [</span><br><span class="line">             &quot;apt-get update -yy&quot;,</span><br><span class="line">             &quot;apt-get install openjdk-8-jdk tomcat8 -yy&quot;,</span><br><span class="line">             &quot;mkdir -p /var/lib/tomcat8/webapps/&quot;</span><br><span class="line">            ]</span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">             &quot;type&quot;: &quot;file&quot;,</span><br><span class="line">             &quot;source&quot;: &quot;target/demo.war&quot;,</span><br><span class="line">             &quot;destination&quot;: &quot;/var/lib/tomcat8/webapps/&quot;</span><br><span class="line">      &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>注释：</p><ul><li>variables：部分用于定义各类变量，最常用的各个平台的API key及secret、region等等</li><li>builders:部分为单个平台images构建镜像所需的配置信息</li><li>provisioners: 机器在被转为静态镜像之前进行的自定义软件及配置操作，可以是shell脚本，或者其他配置管理工具Ansible、Chef等编排脚本。</li></ul></blockquote><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/22e81506.html">https://mds1455975151.github.io/archives/22e81506.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      Packer之Packer应用场景及常用概念介绍
    
    </summary>
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/categories/DevOps/"/>
    
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/tags/DevOps/"/>
    
      <category term="Packer" scheme="https://mds1455975151.github.io/tags/Packer/"/>
    
      <category term="镜像制作" scheme="https://mds1455975151.github.io/tags/%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/"/>
    
      <category term="Aliyun" scheme="https://mds1455975151.github.io/tags/Aliyun/"/>
    
      <category term="资源编排" scheme="https://mds1455975151.github.io/tags/%E8%B5%84%E6%BA%90%E7%BC%96%E6%8E%92/"/>
    
      <category term="google Cloud" scheme="https://mds1455975151.github.io/tags/google-Cloud/"/>
    
      <category term="googlecompute" scheme="https://mds1455975151.github.io/tags/googlecompute/"/>
    
      <category term="应用场景" scheme="https://mds1455975151.github.io/tags/%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/"/>
    
  </entry>
  
  <entry>
    <title>Packer之实战Packer创建Jenkins镜像</title>
    <link href="https://mds1455975151.github.io/archives/6a8f9b85.html"/>
    <id>https://mds1455975151.github.io/archives/6a8f9b85.html</id>
    <published>2018-11-06T04:00:28.000Z</published>
    <updated>2020-04-03T07:09:13.957Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>Packer之实战Packer创建Jenkins镜像</p></blockquote><a id="more"></a><h1 id="准备内容"><a href="#准备内容" class="headerlink" title="准备内容"></a>准备内容</h1><ul><li>google cloud账号一个</li><li>本地服务器安装Packer，请<a href="http://www.mdslq.cn/archives/bc880644.html" target="_blank" rel="noopener">安装Packer</a></li></ul><h1 id="实践操作"><a href="#实践操作" class="headerlink" title="实践操作"></a>实践操作</h1><h2 id="创建Service-Account"><a href="#创建Service-Account" class="headerlink" title="创建Service Account"></a>创建Service Account</h2><p>google云允许你创建并下载一个认证文件，我们可以使用Packer在任何地方使用googlecompute进行构建操作。根据以下步骤获取认证文件：</p><ul><li>登录<a href="https://console.developers.google.com/" target="_blank" rel="noopener">Google Developers Console</a>选择一个项目</li><li>点击IAM和管理–服务账号</li><li>点击创建服务账号，输入服务账号–&gt;给服务账号授予项目权限(可选)–&gt;给用户授予访问服务账号权限(可选)</li><li>最后选择刚创建的服务账号，点击操作部分选择创建密钥下载json或者P12格式密钥文件</li></ul><h2 id="编写模板文件"><a href="#编写模板文件" class="headerlink" title="编写模板文件"></a>编写模板文件</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"># cat jenkins.json</span><br><span class="line">&#123;</span><br><span class="line"> &quot;builders&quot;: [&#123;</span><br><span class="line">       &quot;type&quot;: &quot;googlecompute&quot;,</span><br><span class="line">       &quot;account_file&quot;: &quot;account.json&quot;,</span><br><span class="line">       &quot;project_id&quot;: &quot;axiomatic-port-221011&quot;,</span><br><span class="line">       &quot;source_image_family&quot;: &quot;centos-7&quot;,</span><br><span class="line">       &quot;ssh_username&quot;: &quot;packer&quot;,</span><br><span class="line">       &quot;machine_type&quot;: &quot;n1-standard-1&quot;,</span><br><span class="line">       &quot;image_name&quot;: &quot;centos-4-jenkins-&#123;&#123; timestamp &#125;&#125;&quot;,   # 自定义images名称，默认为packer-&#123;&#123; timestamp &#125;&#125;</span><br><span class="line">       &quot;zone&quot;: &quot;asia-east2-a&quot;</span><br><span class="line">     &#125;],</span><br><span class="line"> &quot;provisioners&quot;: [&#123;</span><br><span class="line">      &quot;type&quot;: &quot;shell&quot;,</span><br><span class="line">      &quot;inline&quot;: [</span><br><span class="line">             &quot;sudo yum update -y&quot;,</span><br><span class="line">             &quot;sudo yum install -y java-1.8.0-openjdk wget&quot;,</span><br><span class="line">             &quot;wget https://pkg.jenkins.io/redhat-stable/jenkins.repo&quot;,</span><br><span class="line">             &quot;sudo cp jenkins.repo /etc/yum.repos.d/jenkins.repo&quot;,</span><br><span class="line">             &quot;sudo rpm --import https://pkg.jenkins.io/redhat-stable/jenkins.io.key&quot;,</span><br><span class="line">             &quot;sudo yum install -y jenkins&quot;,</span><br><span class="line">             &quot;sudo /etc/init.d/jenkins start&quot;,</span><br><span class="line">             &quot;sudo systemctl enable jenkins&quot;</span><br><span class="line">            ]</span><br><span class="line">      &#125;</span><br><span class="line">      ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="执行构建命令"><a href="#执行构建命令" class="headerlink" title="执行构建命令"></a>执行构建命令</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br></pre></td><td class="code"><pre><span class="line"># /usr/local/terraform/bin/packer validate jenkins.json   # 执行前检查下语法，避免无用功</span><br><span class="line">Template validated successfully.</span><br><span class="line"># /usr/local/terraform/bin/packer build jenkins.json</span><br><span class="line">googlecompute output will be in this color.</span><br><span class="line"></span><br><span class="line">==&gt; googlecompute: Checking image does not exist...</span><br><span class="line">==&gt; googlecompute: Creating temporary SSH key for instance...</span><br><span class="line">==&gt; googlecompute: Using image: centos-7-v20181011                      # 选择源镜像</span><br><span class="line">==&gt; googlecompute: Creating instance...</span><br><span class="line">    googlecompute: Loading zone: asia-east2-a                           # 指定的可用区</span><br><span class="line">    googlecompute: Loading machine type: n1-standard-1                  # 指定的配置型号</span><br><span class="line">    googlecompute: Requesting instance creation...                      # 开始创建实例</span><br><span class="line">    googlecompute: Waiting for creation operation to complete...</span><br><span class="line">    googlecompute: Instance has been created!</span><br><span class="line">==&gt; googlecompute: Waiting for the instance to become running...</span><br><span class="line">    googlecompute: IP: 35.241.127.139</span><br><span class="line">==&gt; googlecompute: Using ssh communicator to connect: 35.241.127.139</span><br><span class="line">==&gt; googlecompute: Waiting for SSH to become available...</span><br><span class="line">==&gt; googlecompute: Connected to SSH!</span><br><span class="line">==&gt; googlecompute: Provisioning with shell script: /tmp/packer-shell044651127   # 开始进行自定义软件安装及配置</span><br><span class="line">    googlecompute: Loaded plugins: fastestmirror</span><br><span class="line">    googlecompute: Determining fastest mirrors</span><br><span class="line">    googlecompute:  * base: mirror.fileplanet.com</span><br><span class="line">    googlecompute:  * epel: d2lzkl7pfhq30w.cloudfront.net</span><br><span class="line">    googlecompute:  * extras: mirror.fileplanet.com</span><br><span class="line">    googlecompute:  * updates: mirror.fileplanet.com</span><br><span class="line">    googlecompute: Resolving Dependencies</span><br><span class="line">    googlecompute: --&gt; Running transaction check</span><br><span class="line">    googlecompute: ---&gt; Package google-cloud-sdk.noarch 0:220.0.0-1.el7 will be updated</span><br><span class="line">    googlecompute: ---&gt; Package google-cloud-sdk.noarch 0:223.0.0-1.el7 will be an update</span><br><span class="line">    googlecompute: ---&gt; Package google-compute-engine.noarch 0:2.8.6-1.el7 will be updated</span><br><span class="line">    googlecompute: ---&gt; Package google-compute-engine.noarch 0:2.8.8-1.el7 will be an update</span><br><span class="line">    googlecompute: ---&gt; Package python-google-compute-engine.noarch 0:2.8.6-1.el7 will be updated</span><br><span class="line">    googlecompute: ---&gt; Package python-google-compute-engine.noarch 0:2.8.8-1.el7 will be an update</span><br><span class="line">    googlecompute: ---&gt; Package tzdata.noarch 0:2018e-3.el7 will be updated</span><br><span class="line">    googlecompute: ---&gt; Package tzdata.noarch 0:2018f-2.el7 will be an update</span><br><span class="line">    googlecompute: --&gt; Finished Dependency Resolution</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Dependencies Resolved</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: ================================================================================</span><br><span class="line">    googlecompute:  Package                      Arch   Version         Repository            Size</span><br><span class="line">    googlecompute: ================================================================================</span><br><span class="line">    googlecompute: Updating:</span><br><span class="line">    googlecompute:  google-cloud-sdk             noarch 223.0.0-1.el7   google-cloud-sdk      29 M</span><br><span class="line">    googlecompute:  google-compute-engine        noarch 2.8.8-1.el7     google-cloud-compute  16 k</span><br><span class="line">    googlecompute:  python-google-compute-engine noarch 2.8.8-1.el7     google-cloud-compute 100 k</span><br><span class="line">    googlecompute:  tzdata                       noarch 2018f-2.el7     updates              484 k</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Transaction Summary</span><br><span class="line">    googlecompute: ================================================================================</span><br><span class="line">    googlecompute: Upgrade  4 Packages</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Total download size: 29 M</span><br><span class="line">    googlecompute: Downloading packages:</span><br><span class="line">    googlecompute: Delta RPMs disabled because /usr/bin/applydeltarpm not installed.</span><br><span class="line">    googlecompute: --------------------------------------------------------------------------------</span><br><span class="line">    googlecompute: Total                                               21 MB/s |  29 MB  00:01</span><br><span class="line">    googlecompute: Running transaction check</span><br><span class="line">    googlecompute: Running transaction test</span><br><span class="line">    googlecompute: Transaction test succeeded</span><br><span class="line">    googlecompute: Running transaction</span><br><span class="line">    googlecompute:   Updating   : python-google-compute-engine-2.8.8-1.el7.noarch              1/8</span><br><span class="line">    googlecompute:   Updating   : google-compute-engine-2.8.8-1.el7.noarch                     2/8</span><br><span class="line">    googlecompute:   Updating   : tzdata-2018f-2.el7.noarch                                    3/8</span><br><span class="line">    googlecompute:   Updating   : google-cloud-sdk-223.0.0-1.el7.noarch                        4/8</span><br><span class="line">    googlecompute:   Cleanup    : google-compute-engine-2.8.6-1.el7.noarch                     5/8</span><br><span class="line">    googlecompute:   Cleanup    : python-google-compute-engine-2.8.6-1.el7.noarch              6/8</span><br><span class="line">    googlecompute:   Cleanup    : tzdata-2018e-3.el7.noarch                                    7/8</span><br><span class="line">    googlecompute:   Cleanup    : google-cloud-sdk-220.0.0-1.el7.noarch                        8/8</span><br><span class="line">    googlecompute:   Verifying  : google-compute-engine-2.8.8-1.el7.noarch                     1/8</span><br><span class="line">    googlecompute:   Verifying  : python-google-compute-engine-2.8.8-1.el7.noarch              2/8</span><br><span class="line">    googlecompute:   Verifying  : google-cloud-sdk-223.0.0-1.el7.noarch                        3/8</span><br><span class="line">    googlecompute:   Verifying  : tzdata-2018f-2.el7.noarch                                    4/8</span><br><span class="line">    googlecompute:   Verifying  : google-cloud-sdk-220.0.0-1.el7.noarch                        5/8</span><br><span class="line">    googlecompute:   Verifying  : python-google-compute-engine-2.8.6-1.el7.noarch              6/8</span><br><span class="line">    googlecompute:   Verifying  : tzdata-2018e-3.el7.noarch                                    7/8</span><br><span class="line">    googlecompute:   Verifying  : google-compute-engine-2.8.6-1.el7.noarch                     8/8</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Updated:</span><br><span class="line">    googlecompute:   google-cloud-sdk.noarch 0:223.0.0-1.el7</span><br><span class="line">    googlecompute:   google-compute-engine.noarch 0:2.8.8-1.el7</span><br><span class="line">    googlecompute:   python-google-compute-engine.noarch 0:2.8.8-1.el7</span><br><span class="line">    googlecompute:   tzdata.noarch 0:2018f-2.el7</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Complete!</span><br><span class="line">    googlecompute: Loaded plugins: fastestmirror</span><br><span class="line">    googlecompute: Loading mirror speeds from cached hostfile</span><br><span class="line">    googlecompute:  * base: mirror.fileplanet.com</span><br><span class="line">    googlecompute:  * epel: d2lzkl7pfhq30w.cloudfront.net</span><br><span class="line">    googlecompute:  * extras: mirror.fileplanet.com</span><br><span class="line">    googlecompute:  * updates: mirror.fileplanet.com</span><br><span class="line">    googlecompute: Resolving Dependencies</span><br><span class="line">    googlecompute: --&gt; Running transaction check</span><br><span class="line">    googlecompute: ---&gt; Package java-1.8.0-openjdk.x86_64 1:1.8.0.191.b12-0.el7_5 will be installed</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: java-1.8.0-openjdk-headless(x86-64) = 1:1.8.0.191.b12-0.el7_5 for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: xorg-x11-fonts-Type1 for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libpng15.so.15(PNG15_0)(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libjvm.so(SUNWprivate_1.1)(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libjpeg.so.62(LIBJPEG_6.2)(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libjava.so(SUNWprivate_1.1)(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: fontconfig(x86-64) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libpng15.so.15()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libjvm.so()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libjpeg.so.62()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libjava.so()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libgif.so.4()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libXtst.so.6()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libXrender.so.1()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libXi.so.6()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libXext.so.6()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libXcomposite.so.1()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libX11.so.6()(64bit) for package: 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: ---&gt; Package wget.x86_64 0:1.14-15.el7_4.1 will be installed</span><br><span class="line">    googlecompute: --&gt; Running transaction check</span><br><span class="line">    googlecompute: ---&gt; Package fontconfig.x86_64 0:2.10.95-11.el7 will be installed</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: fontpackages-filesystem for package: fontconfig-2.10.95-11.el7.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: font(:lang=en) for package: fontconfig-2.10.95-11.el7.x86_64</span><br><span class="line">    googlecompute: ---&gt; Package giflib.x86_64 0:4.1.6-9.el7 will be installed</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libSM.so.6()(64bit) for package: giflib-4.1.6-9.el7.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libICE.so.6()(64bit) for package: giflib-4.1.6-9.el7.x86_64</span><br><span class="line">    googlecompute: ---&gt; Package java-1.8.0-openjdk-headless.x86_64 1:1.8.0.191.b12-0.el7_5 will be installed</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: tzdata-java &gt;= 2015d for package: 1:java-1.8.0-openjdk-headless-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: copy-jdk-configs &gt;= 2.2 for package: 1:java-1.8.0-openjdk-headless-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: lksctp-tools(x86-64) for package: 1:java-1.8.0-openjdk-headless-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: jpackage-utils for package: 1:java-1.8.0-openjdk-headless-1.8.0.191.b12-0.el7_5.x86_64</span><br><span class="line">    googlecompute: ---&gt; Package libX11.x86_64 0:1.6.5-1.el7 will be installed</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libX11-common &gt;= 1.6.5-1.el7 for package: libX11-1.6.5-1.el7.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libxcb.so.1()(64bit) for package: libX11-1.6.5-1.el7.x86_64</span><br><span class="line">    googlecompute: ---&gt; Package libXcomposite.x86_64 0:0.4.4-4.1.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libXext.x86_64 0:1.3.3-3.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libXi.x86_64 0:1.7.9-1.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libXrender.x86_64 0:0.9.10-1.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libXtst.x86_64 0:1.2.3-1.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libjpeg-turbo.x86_64 0:1.2.90-5.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libpng.x86_64 2:1.5.13-7.el7_2 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package xorg-x11-fonts-Type1.noarch 0:7.5-9.el7 will be installed</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: ttmkfdir for package: xorg-x11-fonts-Type1-7.5-9.el7.noarch</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: ttmkfdir for package: xorg-x11-fonts-Type1-7.5-9.el7.noarch</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: mkfontdir for package: xorg-x11-fonts-Type1-7.5-9.el7.noarch</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: mkfontdir for package: xorg-x11-fonts-Type1-7.5-9.el7.noarch</span><br><span class="line">    googlecompute: --&gt; Running transaction check</span><br><span class="line">    googlecompute: ---&gt; Package copy-jdk-configs.noarch 0:3.3-10.el7_5 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package fontpackages-filesystem.noarch 0:1.44-8.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package javapackages-tools.noarch 0:3.4.1-11.el7 will be installed</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: python-javapackages = 3.4.1-11.el7 for package: javapackages-tools-3.4.1-11.el7.noarch</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libxslt for package: javapackages-tools-3.4.1-11.el7.noarch</span><br><span class="line">    googlecompute: ---&gt; Package libICE.x86_64 0:1.0.9-9.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libSM.x86_64 0:1.2.2-2.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libX11-common.noarch 0:1.6.5-1.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libxcb.x86_64 0:1.12-1.el7 will be installed</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libXau.so.6()(64bit) for package: libxcb-1.12-1.el7.x86_64</span><br><span class="line">    googlecompute: ---&gt; Package lksctp-tools.x86_64 0:1.0.17-2.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package lyx-fonts.noarch 0:2.2.3-1.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package ttmkfdir.x86_64 0:3.0.9-42.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package tzdata-java.noarch 0:2018f-2.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package xorg-x11-font-utils.x86_64 1:7.5-20.el7 will be installed</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libfontenc.so.1()(64bit) for package: 1:xorg-x11-font-utils-7.5-20.el7.x86_64</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: libXfont.so.1()(64bit) for package: 1:xorg-x11-font-utils-7.5-20.el7.x86_64</span><br><span class="line">    googlecompute: --&gt; Running transaction check</span><br><span class="line">    googlecompute: ---&gt; Package libXau.x86_64 0:1.0.8-2.1.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libXfont.x86_64 0:1.5.2-1.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libfontenc.x86_64 0:1.1.3-3.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package libxslt.x86_64 0:1.1.28-5.el7 will be installed</span><br><span class="line">    googlecompute: ---&gt; Package python-javapackages.noarch 0:3.4.1-11.el7 will be installed</span><br><span class="line">    googlecompute: --&gt; Processing Dependency: python-lxml for package: python-javapackages-3.4.1-11.el7.noarch</span><br><span class="line">    googlecompute: --&gt; Running transaction check</span><br><span class="line">    googlecompute: ---&gt; Package python-lxml.x86_64 0:3.2.1-4.el7 will be installed</span><br><span class="line">    googlecompute: --&gt; Finished Dependency Resolution</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Dependencies Resolved</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: ================================================================================</span><br><span class="line">    googlecompute:  Package                      Arch    Version                    Repository</span><br><span class="line">    googlecompute:                                                                            Size</span><br><span class="line">    googlecompute: ================================================================================</span><br><span class="line">    googlecompute: Installing:</span><br><span class="line">    googlecompute:  java-1.8.0-openjdk           x86_64  1:1.8.0.191.b12-0.el7_5    updates  252 k</span><br><span class="line">    googlecompute:  wget                         x86_64  1.14-15.el7_4.1            base     547 k</span><br><span class="line">    googlecompute: Installing for dependencies:</span><br><span class="line">    googlecompute:  copy-jdk-configs             noarch  3.3-10.el7_5               updates   21 k</span><br><span class="line">    googlecompute:  fontconfig                   x86_64  2.10.95-11.el7             base     229 k</span><br><span class="line">    googlecompute:  fontpackages-filesystem      noarch  1.44-8.el7                 base     9.9 k</span><br><span class="line">    googlecompute:  giflib                       x86_64  4.1.6-9.el7                base      40 k</span><br><span class="line">    googlecompute:  java-1.8.0-openjdk-headless  x86_64  1:1.8.0.191.b12-0.el7_5    updates   32 M</span><br><span class="line">    googlecompute:  javapackages-tools           noarch  3.4.1-11.el7               base      73 k</span><br><span class="line">    googlecompute:  libICE                       x86_64  1.0.9-9.el7                base      66 k</span><br><span class="line">    googlecompute:  libSM                        x86_64  1.2.2-2.el7                base      39 k</span><br><span class="line">    googlecompute:  libX11                       x86_64  1.6.5-1.el7                base     606 k</span><br><span class="line">    googlecompute:  libX11-common                noarch  1.6.5-1.el7                base     164 k</span><br><span class="line">    googlecompute:  libXau                       x86_64  1.0.8-2.1.el7              base      29 k</span><br><span class="line">    googlecompute:  libXcomposite                x86_64  0.4.4-4.1.el7              base      22 k</span><br><span class="line">    googlecompute:  libXext                      x86_64  1.3.3-3.el7                base      39 k</span><br><span class="line">    googlecompute:  libXfont                     x86_64  1.5.2-1.el7                base     152 k</span><br><span class="line">    googlecompute:  libXi                        x86_64  1.7.9-1.el7                base      40 k</span><br><span class="line">    googlecompute:  libXrender                   x86_64  0.9.10-1.el7               base      26 k</span><br><span class="line">    googlecompute:  libXtst                      x86_64  1.2.3-1.el7                base      20 k</span><br><span class="line">    googlecompute:  libfontenc                   x86_64  1.1.3-3.el7                base      31 k</span><br><span class="line">    googlecompute:  libjpeg-turbo                x86_64  1.2.90-5.el7               base     134 k</span><br><span class="line">    googlecompute:  libpng                       x86_64  2:1.5.13-7.el7_2           base     213 k</span><br><span class="line">    googlecompute:  libxcb                       x86_64  1.12-1.el7                 base     211 k</span><br><span class="line">    googlecompute:  libxslt                      x86_64  1.1.28-5.el7               base     242 k</span><br><span class="line">    googlecompute:  lksctp-tools                 x86_64  1.0.17-2.el7               base      88 k</span><br><span class="line">    googlecompute:  lyx-fonts                    noarch  2.2.3-1.el7                epel     159 k</span><br><span class="line">    googlecompute:  python-javapackages          noarch  3.4.1-11.el7               base      31 k</span><br><span class="line">    googlecompute:  python-lxml                  x86_64  3.2.1-4.el7                base     758 k</span><br><span class="line">    googlecompute:  ttmkfdir                     x86_64  3.0.9-42.el7               base      48 k</span><br><span class="line">    googlecompute:  tzdata-java                  noarch  2018f-2.el7                updates  186 k</span><br><span class="line">    googlecompute:  xorg-x11-font-utils          x86_64  1:7.5-20.el7               base      87 k</span><br><span class="line">    googlecompute:  xorg-x11-fonts-Type1         noarch  7.5-9.el7                  base     521 k</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Transaction Summary</span><br><span class="line">    googlecompute: ================================================================================</span><br><span class="line">    googlecompute: Install  2 Packages (+30 Dependent packages)</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Total download size: 37 M</span><br><span class="line">    googlecompute: Installed size: 117 M</span><br><span class="line">    googlecompute: Downloading packages:</span><br><span class="line">    googlecompute: --------------------------------------------------------------------------------</span><br><span class="line">    googlecompute: Total                                              7.2 MB/s |  37 MB  00:05</span><br><span class="line">    googlecompute: Running transaction check</span><br><span class="line">    googlecompute: Running transaction test</span><br><span class="line">    googlecompute: Transaction test succeeded</span><br><span class="line">    googlecompute: Running transaction</span><br><span class="line">    googlecompute:   Installing : libfontenc-1.1.3-3.el7.x86_64                               1/32</span><br><span class="line">    googlecompute:   Installing : libxslt-1.1.28-5.el7.x86_64                                 2/32</span><br><span class="line">    googlecompute:   Installing : fontpackages-filesystem-1.44-8.el7.noarch                   3/32</span><br><span class="line">    googlecompute:   Installing : libjpeg-turbo-1.2.90-5.el7.x86_64                           4/32</span><br><span class="line">    googlecompute:   Installing : libICE-1.0.9-9.el7.x86_64                                   5/32</span><br><span class="line">    googlecompute:   Installing : libSM-1.2.2-2.el7.x86_64                                    6/32</span><br><span class="line">    googlecompute:   Installing : lyx-fonts-2.2.3-1.el7.noarch                                7/32</span><br><span class="line">    googlecompute:   Installing : fontconfig-2.10.95-11.el7.x86_64                            8/32</span><br><span class="line">    googlecompute:   Installing : python-lxml-3.2.1-4.el7.x86_64                              9/32</span><br><span class="line">    googlecompute:   Installing : python-javapackages-3.4.1-11.el7.noarch                    10/32</span><br><span class="line">    googlecompute:   Installing : javapackages-tools-3.4.1-11.el7.noarch                     11/32</span><br><span class="line">    googlecompute:   Installing : libXfont-1.5.2-1.el7.x86_64                                12/32</span><br><span class="line">    googlecompute:   Installing : 1:xorg-x11-font-utils-7.5-20.el7.x86_64                    13/32</span><br><span class="line">    googlecompute:   Installing : libXau-1.0.8-2.1.el7.x86_64                                14/32</span><br><span class="line">    googlecompute:   Installing : libxcb-1.12-1.el7.x86_64                                   15/32</span><br><span class="line">    googlecompute:   Installing : libX11-common-1.6.5-1.el7.noarch                           16/32</span><br><span class="line">    googlecompute:   Installing : libX11-1.6.5-1.el7.x86_64                                  17/32</span><br><span class="line">    googlecompute:   Installing : libXext-1.3.3-3.el7.x86_64                                 18/32</span><br><span class="line">    googlecompute:   Installing : libXi-1.7.9-1.el7.x86_64                                   19/32</span><br><span class="line">    googlecompute:   Installing : libXtst-1.2.3-1.el7.x86_64                                 20/32</span><br><span class="line">    googlecompute:   Installing : giflib-4.1.6-9.el7.x86_64                                  21/32</span><br><span class="line">    googlecompute:   Installing : libXrender-0.9.10-1.el7.x86_64                             22/32</span><br><span class="line">    googlecompute:   Installing : libXcomposite-0.4.4-4.1.el7.x86_64                         23/32</span><br><span class="line">    googlecompute:   Installing : lksctp-tools-1.0.17-2.el7.x86_64                           24/32</span><br><span class="line">    googlecompute:   Installing : tzdata-java-2018f-2.el7.noarch                             25/32</span><br><span class="line">    googlecompute:   Installing : copy-jdk-configs-3.3-10.el7_5.noarch                       26/32</span><br><span class="line">    googlecompute:   Installing : 1:java-1.8.0-openjdk-headless-1.8.0.191.b12-0.el7_5.x86_   27/32</span><br><span class="line">    googlecompute:   Installing : ttmkfdir-3.0.9-42.el7.x86_64                               28/32</span><br><span class="line">    googlecompute:   Installing : xorg-x11-fonts-Type1-7.5-9.el7.noarch                      29/32</span><br><span class="line">    googlecompute:   Installing : 2:libpng-1.5.13-7.el7_2.x86_64                             30/32</span><br><span class="line">    googlecompute:   Installing : 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64          31/32</span><br><span class="line">    googlecompute:   Installing : wget-1.14-15.el7_4.1.x86_64                                32/32</span><br><span class="line">    googlecompute:   Verifying  : libXext-1.3.3-3.el7.x86_64                                  1/32</span><br><span class="line">    googlecompute:   Verifying  : libX11-1.6.5-1.el7.x86_64                                   2/32</span><br><span class="line">    googlecompute:   Verifying  : libXi-1.7.9-1.el7.x86_64                                    3/32</span><br><span class="line">    googlecompute:   Verifying  : libICE-1.0.9-9.el7.x86_64                                   4/32</span><br><span class="line">    googlecompute:   Verifying  : giflib-4.1.6-9.el7.x86_64                                   5/32</span><br><span class="line">    googlecompute:   Verifying  : libjpeg-turbo-1.2.90-5.el7.x86_64                           6/32</span><br><span class="line">    googlecompute:   Verifying  : libXrender-0.9.10-1.el7.x86_64                              7/32</span><br><span class="line">    googlecompute:   Verifying  : lyx-fonts-2.2.3-1.el7.noarch                                8/32</span><br><span class="line">    googlecompute:   Verifying  : libXfont-1.5.2-1.el7.x86_64                                 9/32</span><br><span class="line">    googlecompute:   Verifying  : python-lxml-3.2.1-4.el7.x86_64                             10/32</span><br><span class="line">    googlecompute:   Verifying  : 2:libpng-1.5.13-7.el7_2.x86_64                             11/32</span><br><span class="line">    googlecompute:   Verifying  : fontpackages-filesystem-1.44-8.el7.noarch                  12/32</span><br><span class="line">    googlecompute:   Verifying  : ttmkfdir-3.0.9-42.el7.x86_64                               13/32</span><br><span class="line">    googlecompute:   Verifying  : 1:java-1.8.0-openjdk-1.8.0.191.b12-0.el7_5.x86_64          14/32</span><br><span class="line">    googlecompute:   Verifying  : copy-jdk-configs-3.3-10.el7_5.noarch                       15/32</span><br><span class="line">    googlecompute:   Verifying  : python-javapackages-3.4.1-11.el7.noarch                    16/32</span><br><span class="line">    googlecompute:   Verifying  : 1:java-1.8.0-openjdk-headless-1.8.0.191.b12-0.el7_5.x86_   17/32</span><br><span class="line">    googlecompute:   Verifying  : libXcomposite-0.4.4-4.1.el7.x86_64                         18/32</span><br><span class="line">    googlecompute:   Verifying  : libXtst-1.2.3-1.el7.x86_64                                 19/32</span><br><span class="line">    googlecompute:   Verifying  : tzdata-java-2018f-2.el7.noarch                             20/32</span><br><span class="line">    googlecompute:   Verifying  : lksctp-tools-1.0.17-2.el7.x86_64                           21/32</span><br><span class="line">    googlecompute:   Verifying  : libxcb-1.12-1.el7.x86_64                                   22/32</span><br><span class="line">    googlecompute:   Verifying  : wget-1.14-15.el7_4.1.x86_64                                23/32</span><br><span class="line">    googlecompute:   Verifying  : libxslt-1.1.28-5.el7.x86_64                                24/32</span><br><span class="line">    googlecompute:   Verifying  : xorg-x11-fonts-Type1-7.5-9.el7.noarch                      25/32</span><br><span class="line">    googlecompute:   Verifying  : javapackages-tools-3.4.1-11.el7.noarch                     26/32</span><br><span class="line">    googlecompute:   Verifying  : libX11-common-1.6.5-1.el7.noarch                           27/32</span><br><span class="line">    googlecompute:   Verifying  : libXau-1.0.8-2.1.el7.x86_64                                28/32</span><br><span class="line">    googlecompute:   Verifying  : libSM-1.2.2-2.el7.x86_64                                   29/32</span><br><span class="line">    googlecompute:   Verifying  : fontconfig-2.10.95-11.el7.x86_64                           30/32</span><br><span class="line">    googlecompute:   Verifying  : libfontenc-1.1.3-3.el7.x86_64                              31/32</span><br><span class="line">    googlecompute:   Verifying  : 1:xorg-x11-font-utils-7.5-20.el7.x86_64                    32/32</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Installed:</span><br><span class="line">    googlecompute:   java-1.8.0-openjdk.x86_64 1:1.8.0.191.b12-0.el7_5</span><br><span class="line">    googlecompute:   wget.x86_64 0:1.14-15.el7_4.1</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Dependency Installed:</span><br><span class="line">    googlecompute:   copy-jdk-configs.noarch 0:3.3-10.el7_5</span><br><span class="line">    googlecompute:   fontconfig.x86_64 0:2.10.95-11.el7</span><br><span class="line">    googlecompute:   fontpackages-filesystem.noarch 0:1.44-8.el7</span><br><span class="line">    googlecompute:   giflib.x86_64 0:4.1.6-9.el7</span><br><span class="line">    googlecompute:   java-1.8.0-openjdk-headless.x86_64 1:1.8.0.191.b12-0.el7_5</span><br><span class="line">    googlecompute:   javapackages-tools.noarch 0:3.4.1-11.el7</span><br><span class="line">    googlecompute:   libICE.x86_64 0:1.0.9-9.el7</span><br><span class="line">    googlecompute:   libSM.x86_64 0:1.2.2-2.el7</span><br><span class="line">    googlecompute:   libX11.x86_64 0:1.6.5-1.el7</span><br><span class="line">    googlecompute:   libX11-common.noarch 0:1.6.5-1.el7</span><br><span class="line">    googlecompute:   libXau.x86_64 0:1.0.8-2.1.el7</span><br><span class="line">    googlecompute:   libXcomposite.x86_64 0:0.4.4-4.1.el7</span><br><span class="line">    googlecompute:   libXext.x86_64 0:1.3.3-3.el7</span><br><span class="line">    googlecompute:   libXfont.x86_64 0:1.5.2-1.el7</span><br><span class="line">    googlecompute:   libXi.x86_64 0:1.7.9-1.el7</span><br><span class="line">    googlecompute:   libXrender.x86_64 0:0.9.10-1.el7</span><br><span class="line">    googlecompute:   libXtst.x86_64 0:1.2.3-1.el7</span><br><span class="line">    googlecompute:   libfontenc.x86_64 0:1.1.3-3.el7</span><br><span class="line">    googlecompute:   libjpeg-turbo.x86_64 0:1.2.90-5.el7</span><br><span class="line">    googlecompute:   libpng.x86_64 2:1.5.13-7.el7_2</span><br><span class="line">    googlecompute:   libxcb.x86_64 0:1.12-1.el7</span><br><span class="line">    googlecompute:   libxslt.x86_64 0:1.1.28-5.el7</span><br><span class="line">    googlecompute:   lksctp-tools.x86_64 0:1.0.17-2.el7</span><br><span class="line">    googlecompute:   lyx-fonts.noarch 0:2.2.3-1.el7</span><br><span class="line">    googlecompute:   python-javapackages.noarch 0:3.4.1-11.el7</span><br><span class="line">    googlecompute:   python-lxml.x86_64 0:3.2.1-4.el7</span><br><span class="line">    googlecompute:   ttmkfdir.x86_64 0:3.0.9-42.el7</span><br><span class="line">    googlecompute:   tzdata-java.noarch 0:2018f-2.el7</span><br><span class="line">    googlecompute:   xorg-x11-font-utils.x86_64 1:7.5-20.el7</span><br><span class="line">    googlecompute:   xorg-x11-fonts-Type1.noarch 0:7.5-9.el7</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Complete!</span><br><span class="line">    googlecompute: --2018-11-06 07:42:41--  https://pkg.jenkins.io/redhat-stable/jenkins.repo</span><br><span class="line">    googlecompute: Resolving pkg.jenkins.io (pkg.jenkins.io)... 52.202.51.185</span><br><span class="line">    googlecompute: Connecting to pkg.jenkins.io (pkg.jenkins.io)|52.202.51.185|:443... connected.</span><br><span class="line">    googlecompute: HTTP request sent, awaiting response... 200 OK</span><br><span class="line">    googlecompute: Length: 85</span><br><span class="line">    googlecompute: Saving to: ‘jenkins.repo’</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute:      0K                                                       100% 3.16M=0s</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: 2018-11-06 07:42:42 (3.16 MB/s) - ‘jenkins.repo’ saved [85/85]</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Loaded plugins: fastestmirror</span><br><span class="line">    googlecompute: Loading mirror speeds from cached hostfile</span><br><span class="line">    googlecompute:  * base: mirror.fileplanet.com</span><br><span class="line">    googlecompute:  * epel: d2lzkl7pfhq30w.cloudfront.net</span><br><span class="line">    googlecompute:  * extras: mirror.fileplanet.com</span><br><span class="line">    googlecompute:  * updates: mirror.fileplanet.com</span><br><span class="line">    googlecompute: Resolving Dependencies</span><br><span class="line">    googlecompute: --&gt; Running transaction check</span><br><span class="line">    googlecompute: ---&gt; Package jenkins.noarch 0:2.138.2-1.1 will be installed</span><br><span class="line">    googlecompute: --&gt; Finished Dependency Resolution</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Dependencies Resolved</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: ================================================================================</span><br><span class="line">    googlecompute:  Package          Arch            Version                Repository        Size</span><br><span class="line">    googlecompute: ================================================================================</span><br><span class="line">    googlecompute: Installing:</span><br><span class="line">    googlecompute:  jenkins          noarch          2.138.2-1.1            jenkins           72 M</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Transaction Summary</span><br><span class="line">    googlecompute: ================================================================================</span><br><span class="line">    googlecompute: Install  1 Package</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Total download size: 72 M</span><br><span class="line">    googlecompute: Installed size: 72 M</span><br><span class="line">    googlecompute: Downloading packages:</span><br><span class="line">    googlecompute: Running transaction check</span><br><span class="line">    googlecompute: Running transaction test</span><br><span class="line">    googlecompute: Transaction test succeeded</span><br><span class="line">    googlecompute: Running transaction</span><br><span class="line">    googlecompute:   Installing : jenkins-2.138.2-1.1.noarch                                   1/1</span><br><span class="line">    googlecompute:   Verifying  : jenkins-2.138.2-1.1.noarch                                   1/1</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Installed:</span><br><span class="line">    googlecompute:   jenkins.noarch 0:2.138.2-1.1</span><br><span class="line">    googlecompute:</span><br><span class="line">    googlecompute: Complete!</span><br><span class="line">    googlecompute: Starting jenkins (via systemctl):  [  OK  ]</span><br><span class="line">    googlecompute: jenkins.service is not a native service, redirecting to /sbin/chkconfig.</span><br><span class="line">    googlecompute: Executing /sbin/chkconfig jenkins on</span><br><span class="line">==&gt; googlecompute: Deleting instance...</span><br><span class="line">    googlecompute: Instance has been deleted!</span><br><span class="line">==&gt; googlecompute: Creating image...</span><br><span class="line">==&gt; googlecompute: Deleting disk...</span><br><span class="line">    googlecompute: Disk has been deleted!</span><br><span class="line">Build &apos;googlecompute&apos; finished.</span><br><span class="line"></span><br><span class="line">==&gt; Builds finished. The artifacts of successful builds are:</span><br><span class="line">--&gt; googlecompute: A disk image was created: centos-4-jenkins-1541491568        # 输出镜像名称</span><br></pre></td></tr></table></figure><p><img src="/archives/6a8f9b85/01.png" alt=""></p><h2 id="验证镜像可用性"><a href="#验证镜像可用性" class="headerlink" title="验证镜像可用性"></a>验证镜像可用性</h2><p>利用terraform调用刚刚生成的镜像创建Jenkins服务<br></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"># cat main.tf</span><br><span class="line">resource &quot;google_compute_instance&quot; &quot;vm_instance&quot; &#123;</span><br><span class="line">  name         = &quot;jenkins-instance&quot;</span><br><span class="line">  machine_type = &quot;$&#123;var.machine_type&#125;&quot;</span><br><span class="line">  tags         = [&quot;instance&quot;]</span><br><span class="line"></span><br><span class="line">  boot_disk &#123;</span><br><span class="line">    initialize_params &#123;</span><br><span class="line">      image = &quot;$&#123;var.image&#125;&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  network_interface &#123;</span><br><span class="line">    # A default network is created for all GCP projects</span><br><span class="line">    network = &quot;$&#123;google_compute_network.vpc_network.self_link&#125;&quot;</span><br><span class="line">    access_config = &#123;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#-----------------------------------------------------------------------</span><br><span class="line">resource &quot;google_compute_network&quot; &quot;vpc_network&quot; &#123;</span><br><span class="line">  name                    = &quot;terraform-network&quot;</span><br><span class="line">  auto_create_subnetworks = &quot;true&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#-----------------------------------------------------------------------</span><br><span class="line">resource &quot;google_compute_firewall&quot; &quot;vpc_firewall&quot; &#123;</span><br><span class="line">  name    = &quot;terraform-firewall&quot;</span><br><span class="line">  network = &quot;$&#123;google_compute_network.vpc_network.name&#125;&quot;</span><br><span class="line"></span><br><span class="line">  allow &#123;</span><br><span class="line">    protocol = &quot;icmp&quot;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  allow &#123;</span><br><span class="line">    protocol = &quot;tcp&quot;</span><br><span class="line">    ports    = [&quot;22&quot;, &quot;80&quot;, &quot;443&quot;, &quot;3389&quot;, &quot;8080&quot;]</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  source_ranges = [&quot;0.0.0.0/0&quot;]</span><br><span class="line">  source_tags = [&quot;web&quot;]</span><br><span class="line">&#125;</span><br><span class="line">#-----------------------------------------------------------------------</span><br><span class="line">output &quot;lan_ip&quot; &#123;</span><br><span class="line">  value = &quot;$&#123;google_compute_instance.vm_instance.network_interface.0.address&#125;&quot;</span><br><span class="line">&#125;</span><br><span class="line">output &quot;wan_ip&quot; &#123;</span><br><span class="line">  value = &quot;$&#123;google_compute_instance.vm_instance.network_interface.0.access_config.0.nat_ip&#125;&quot;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># terraform apply</span><br><span class="line">google_compute_network.vpc_network: Refreshing state... (ID: terraform-network)</span><br><span class="line">google_compute_firewall.vpc_firewall: Refreshing state... (ID: terraform-firewall)</span><br><span class="line"></span><br><span class="line">An execution plan has been generated and is shown below.</span><br><span class="line">Resource actions are indicated with the following symbols:</span><br><span class="line">  + create</span><br><span class="line"></span><br><span class="line">Terraform will perform the following actions:</span><br><span class="line"></span><br><span class="line">  + google_compute_instance.vm_instance</span><br><span class="line">      id:                                                  &lt;computed&gt;</span><br><span class="line">      boot_disk.#:                                         &quot;1&quot;</span><br><span class="line">      boot_disk.0.auto_delete:                             &quot;true&quot;</span><br><span class="line">      boot_disk.0.device_name:                             &lt;computed&gt;</span><br><span class="line">      boot_disk.0.disk_encryption_key_sha256:              &lt;computed&gt;</span><br><span class="line">      boot_disk.0.initialize_params.#:                     &quot;1&quot;</span><br><span class="line">      boot_disk.0.initialize_params.0.image:               &quot;centos-4-jenkins-1541491568&quot;</span><br><span class="line">      boot_disk.0.initialize_params.0.size:                &lt;computed&gt;</span><br><span class="line">      boot_disk.0.initialize_params.0.type:                &lt;computed&gt;</span><br><span class="line">      can_ip_forward:                                      &quot;false&quot;</span><br><span class="line">      cpu_platform:                                        &lt;computed&gt;</span><br><span class="line">      create_timeout:                                      &quot;4&quot;</span><br><span class="line">      deletion_protection:                                 &quot;false&quot;</span><br><span class="line">      guest_accelerator.#:                                 &lt;computed&gt;</span><br><span class="line">      instance_id:                                         &lt;computed&gt;</span><br><span class="line">      label_fingerprint:                                   &lt;computed&gt;</span><br><span class="line">      machine_type:                                        &quot;n1-standard-1&quot;</span><br><span class="line">      metadata_fingerprint:                                &lt;computed&gt;</span><br><span class="line">      name:                                                &quot;jenkins-instance&quot;</span><br><span class="line">      network_interface.#:                                 &quot;1&quot;</span><br><span class="line">      network_interface.0.access_config.#:                 &quot;1&quot;</span><br><span class="line">      network_interface.0.access_config.0.assigned_nat_ip: &lt;computed&gt;</span><br><span class="line">      network_interface.0.access_config.0.nat_ip:          &lt;computed&gt;</span><br><span class="line">      network_interface.0.access_config.0.network_tier:    &lt;computed&gt;</span><br><span class="line">      network_interface.0.address:                         &lt;computed&gt;</span><br><span class="line">      network_interface.0.name:                            &lt;computed&gt;</span><br><span class="line">      network_interface.0.network:                         &quot;https://www.googleapis.com/compute/v1/projects/axiomatic-port-221011/global/networks/terraform-network&quot;</span><br><span class="line">      network_interface.0.network_ip:                      &lt;computed&gt;</span><br><span class="line">      network_interface.0.subnetwork_project:              &lt;computed&gt;</span><br><span class="line">      project:                                             &lt;computed&gt;</span><br><span class="line">      scheduling.#:                                        &lt;computed&gt;</span><br><span class="line">      self_link:                                           &lt;computed&gt;</span><br><span class="line">      tags.#:                                              &quot;1&quot;</span><br><span class="line">      tags.1110487518:                                     &quot;instance&quot;</span><br><span class="line">      tags_fingerprint:                                    &lt;computed&gt;</span><br><span class="line">      zone:                                                &lt;computed&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Plan: 1 to add, 0 to change, 0 to destroy.</span><br><span class="line"></span><br><span class="line">Do you want to perform these actions?</span><br><span class="line">  Terraform will perform the actions described above.</span><br><span class="line">  Only &apos;yes&apos; will be accepted to approve.</span><br><span class="line"></span><br><span class="line">  Enter a value: yes</span><br><span class="line"></span><br><span class="line">google_compute_instance.vm_instance: Creating...</span><br><span class="line">  boot_disk.#:                                         &quot;&quot; =&gt; &quot;1&quot;</span><br><span class="line">  boot_disk.0.auto_delete:                             &quot;&quot; =&gt; &quot;true&quot;</span><br><span class="line">  boot_disk.0.device_name:                             &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  boot_disk.0.disk_encryption_key_sha256:              &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  boot_disk.0.initialize_params.#:                     &quot;&quot; =&gt; &quot;1&quot;</span><br><span class="line">  boot_disk.0.initialize_params.0.image:               &quot;&quot; =&gt; &quot;centos-4-jenkins-1541491568&quot;</span><br><span class="line">  boot_disk.0.initialize_params.0.size:                &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  boot_disk.0.initialize_params.0.type:                &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  can_ip_forward:                                      &quot;&quot; =&gt; &quot;false&quot;</span><br><span class="line">  cpu_platform:                                        &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  create_timeout:                                      &quot;&quot; =&gt; &quot;4&quot;</span><br><span class="line">  deletion_protection:                                 &quot;&quot; =&gt; &quot;false&quot;</span><br><span class="line">  guest_accelerator.#:                                 &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  instance_id:                                         &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  label_fingerprint:                                   &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  machine_type:                                        &quot;&quot; =&gt; &quot;n1-standard-1&quot;</span><br><span class="line">  metadata_fingerprint:                                &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  name:                                                &quot;&quot; =&gt; &quot;jenkins-instance&quot;</span><br><span class="line">  network_interface.#:                                 &quot;&quot; =&gt; &quot;1&quot;</span><br><span class="line">  network_interface.0.access_config.#:                 &quot;&quot; =&gt; &quot;1&quot;</span><br><span class="line">  network_interface.0.access_config.0.assigned_nat_ip: &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  network_interface.0.access_config.0.nat_ip:          &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  network_interface.0.access_config.0.network_tier:    &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  network_interface.0.address:                         &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  network_interface.0.name:                            &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  network_interface.0.network:                         &quot;&quot; =&gt; &quot;https://www.googleapis.com/compute/v1/projects/axiomatic-port-221011/global/networks/terraform-network&quot;</span><br><span class="line">  network_interface.0.network_ip:                      &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  network_interface.0.subnetwork_project:              &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  project:                                             &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  scheduling.#:                                        &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  self_link:                                           &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  tags.#:                                              &quot;&quot; =&gt; &quot;1&quot;</span><br><span class="line">  tags.1110487518:                                     &quot;&quot; =&gt; &quot;instance&quot;</span><br><span class="line">  tags_fingerprint:                                    &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">  zone:                                                &quot;&quot; =&gt; &quot;&lt;computed&gt;&quot;</span><br><span class="line">google_compute_instance.vm_instance: Still creating... (10s elapsed)</span><br><span class="line">google_compute_instance.vm_instance: Still creating... (20s elapsed)</span><br><span class="line">google_compute_instance.vm_instance: Creation complete after 29s (ID: jenkins-instance)</span><br><span class="line"></span><br><span class="line">Apply complete! Resources: 1 added, 0 changed, 0 destroyed.</span><br><span class="line"></span><br><span class="line">Outputs:</span><br><span class="line"></span><br><span class="line">lan_ip = 10.170.0.2</span><br><span class="line">wan_ip = 35.241.127.139</span><br></pre></td></tr></table></figure><p></p><p>访问服务：<a href="http://35.241.127.139:8080/" target="_blank" rel="noopener">http://35.241.127.139:8080/</a><br>可以在镜像制作过程中直接将jenkins服务配置更完善，这边直接应用服务<br><img src="/archives/6a8f9b85/02.png" alt=""></p><h2 id="验证完毕，销毁资源"><a href="#验证完毕，销毁资源" class="headerlink" title="验证完毕，销毁资源"></a>验证完毕，销毁资源</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">terraform destroy</span><br><span class="line">google_compute_network.vpc_network: Refreshing state... (ID: terraform-network)</span><br><span class="line">google_compute_firewall.vpc_firewall: Refreshing state... (ID: terraform-firewall)</span><br><span class="line">google_compute_instance.vm_instance: Refreshing state... (ID: jenkins-instance)</span><br><span class="line"></span><br><span class="line">An execution plan has been generated and is shown below.</span><br><span class="line">Resource actions are indicated with the following symbols:</span><br><span class="line">  - destroy</span><br><span class="line"></span><br><span class="line">Terraform will perform the following actions:</span><br><span class="line"></span><br><span class="line">  - google_compute_firewall.vpc_firewall</span><br><span class="line"></span><br><span class="line">  - google_compute_instance.vm_instance</span><br><span class="line"></span><br><span class="line">  - google_compute_network.vpc_network</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Plan: 0 to add, 0 to change, 3 to destroy.</span><br><span class="line"></span><br><span class="line">Do you really want to destroy all resources?</span><br><span class="line">  Terraform will destroy all your managed infrastructure, as shown above.</span><br><span class="line">  There is no undo. Only &apos;yes&apos; will be accepted to confirm.</span><br><span class="line"></span><br><span class="line">  Enter a value: yes</span><br><span class="line"></span><br><span class="line">google_compute_firewall.vpc_firewall: Destroying... (ID: terraform-firewall)</span><br><span class="line">google_compute_instance.vm_instance: Destroying... (ID: jenkins-instance)</span><br><span class="line">google_compute_firewall.vpc_firewall: Still destroying... (ID: terraform-firewall, 10s elapsed)</span><br><span class="line">google_compute_instance.vm_instance: Still destroying... (ID: jenkins-instance, 10s elapsed)</span><br><span class="line">google_compute_firewall.vpc_firewall: Destruction complete after 11s</span><br><span class="line">google_compute_instance.vm_instance: Still destroying... (ID: jenkins-instance, 20s elapsed)</span><br><span class="line">google_compute_instance.vm_instance: Destruction complete after 26s</span><br><span class="line">google_compute_network.vpc_network: Destroying... (ID: terraform-network)</span><br><span class="line">google_compute_network.vpc_network: Still destroying... (ID: terraform-network, 10s elapsed)</span><br><span class="line">google_compute_network.vpc_network: Still destroying... (ID: terraform-network, 20s elapsed)</span><br><span class="line">google_compute_network.vpc_network: Still destroying... (ID: terraform-network, 30s elapsed)</span><br><span class="line">google_compute_network.vpc_network: Still destroying... (ID: terraform-network, 40s elapsed)</span><br><span class="line">google_compute_network.vpc_network: Still destroying... (ID: terraform-network, 50s elapsed)</span><br><span class="line">google_compute_network.vpc_network: Still destroying... (ID: terraform-network, 1m0s elapsed)</span><br><span class="line">google_compute_network.vpc_network: Destruction complete after 1m9s</span><br><span class="line"></span><br><span class="line">Destroy complete! Resources: 3 destroyed.</span><br></pre></td></tr></table></figure><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><ul><li>Packer官网：<a href="https://www.packer.io/" target="_blank" rel="noopener">https://www.packer.io/</a></li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/6a8f9b85.html">https://mds1455975151.github.io/archives/6a8f9b85.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      Packer之实战Packer创建Jenkins镜像
    
    </summary>
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/categories/DevOps/"/>
    
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/tags/DevOps/"/>
    
      <category term="Jenkins" scheme="https://mds1455975151.github.io/tags/Jenkins/"/>
    
      <category term="Packer" scheme="https://mds1455975151.github.io/tags/Packer/"/>
    
      <category term="镜像制作" scheme="https://mds1455975151.github.io/tags/%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/"/>
    
      <category term="Aliyun" scheme="https://mds1455975151.github.io/tags/Aliyun/"/>
    
      <category term="资源编排" scheme="https://mds1455975151.github.io/tags/%E8%B5%84%E6%BA%90%E7%BC%96%E6%8E%92/"/>
    
      <category term="google Cloud" scheme="https://mds1455975151.github.io/tags/google-Cloud/"/>
    
      <category term="googlecompute" scheme="https://mds1455975151.github.io/tags/googlecompute/"/>
    
      <category term="应用场景" scheme="https://mds1455975151.github.io/tags/%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF/"/>
    
  </entry>
  
  <entry>
    <title>Packer之Packer介绍</title>
    <link href="https://mds1455975151.github.io/archives/bc880644.html"/>
    <id>https://mds1455975151.github.io/archives/bc880644.html</id>
    <published>2018-11-06T03:37:45.000Z</published>
    <updated>2020-04-03T07:09:13.952Z</updated>
    
    <content type="html"><![CDATA[<script src="/assets/js/APlayer.min.js"> </script><!-- build time:Sat May 09 2020 21:14:38 GMT+0800 (GMT+08:00) --><blockquote><p>Packer之Packer介绍</p></blockquote><a id="more"></a><h1 id="Packer介绍"><a href="#Packer介绍" class="headerlink" title="Packer介绍"></a>Packer介绍</h1><p>所谓的镜像，就是一个包含预先配置好操作系统和预装软件的静态单元，通过它可以快速的创建新的虚拟机运行实例，不同的平台支持不同的镜像格式，例如AWS的EC2支持AMIs，VMware支持VMDK/VMX,Alicloud的ECS支持RAW和VHD格式等等。各云平台都提供了大量的基础镜像供用户使用，但是随着云平台用户成熟度的增加，用户对镜像个性化的需要越来越强烈，同时出于商业的考虑，用户也希望自己的系统具有在不同云平台之间迁移的能力，当然也包含个性化的镜像迁移的能力。尽管各大云平台都提供了WEB界面工具使得用户可以手工创建自定义镜像，也开放了相应的API使得通过自动化的脚本来创建个性化的自定义镜像成为可能。但是都存在一定的局限性而难以满足用户的最终需求，Packer就在这种背景下诞生了。</p><p>Packer是一个从单一的模板文件来创建多平台一致性镜像的轻量级开源工具，它能够运行在常用的主流操作系统如Windows、Linux和Mac os上，能够高效的并行创建多平台例如AWS、Azure和Alicloud的镜像，它的目的并不是取代Puppet/Chef等配置管理工具，实际上，当制作镜像的时候，Packer可以使用Chef或者Puppet等工具来安装镜像所需要的软件。通过Packer自动化的创建各种平台的镜像是非常容易的。</p><p>优势：</p><ul><li>基础设施部署迅速</li><li>可以移植性</li><li>镜像制作自动化，提升效率，降低误操作</li><li>支持所有常见的公有云厂商</li><li>支持自定义插件(可自增强)</li><li>开源(成熟、透明)</li></ul><h1 id="工作流程"><a href="#工作流程" class="headerlink" title="工作流程"></a>工作流程</h1><p>大致流程：模板–&gt;基于公有云基础镜像–&gt;创建主机、自定义设置–&gt;创建镜像–上传镜像–&gt;删除主机–&gt;返回镜像信息</p><h1 id="Packer安装部署"><a href="#Packer安装部署" class="headerlink" title="Packer安装部署"></a>Packer安装部署</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># wget https://releases.hashicorp.com/packer/1.3.2/packer_1.3.2_linux_amd64.zip</span><br><span class="line"># unzip packer_1.3.2_linux_amd64.zip</span><br><span class="line"># packer --version</span><br><span class="line">1.3.2</span><br><span class="line"># packer -h</span><br><span class="line">Usage: packer [--version] [--help] &lt;command&gt; [&lt;args&gt;]</span><br><span class="line"></span><br><span class="line">Available commands are:</span><br><span class="line">    build       build image(s) from template</span><br><span class="line">    fix         fixes templates from old versions of packer</span><br><span class="line">    inspect     see components of a template</span><br><span class="line">    validate    check that a template is valid</span><br><span class="line">    version     Prints the Packer version</span><br></pre></td></tr></table></figure><blockquote><p><strong>注意</strong>: 下载解压后使用的时候建议使用包的绝对路径执行，因为包名和Linux下另外一个二进制包重名了，或者将packer重命名，例如：packer.io等等</p></blockquote><h1 id="基于google-Cloud案例"><a href="#基于google-Cloud案例" class="headerlink" title="基于google Cloud案例"></a>基于google Cloud案例</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"># cat google.json</span><br><span class="line">&#123;</span><br><span class="line">  &quot;builders&quot;: [</span><br><span class="line">    &#123;</span><br><span class="line">      &quot;type&quot;: &quot;googlecompute&quot;,</span><br><span class="line">      &quot;account_file&quot;: &quot;account.json&quot;,</span><br><span class="line">      &quot;project_id&quot;: &quot;xxx&quot;,</span><br><span class="line">      &quot;source_image&quot;: &quot;debian-7-wheezy-v20150127&quot;,</span><br><span class="line">      &quot;ssh_username&quot;: &quot;packer&quot;,</span><br><span class="line">      &quot;zone&quot;: &quot;us-central1-a&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  ]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"># ./packer build google.json</span><br><span class="line">googlecompute output will be in this color.</span><br><span class="line"></span><br><span class="line">==&gt; googlecompute: Checking image does not exist...</span><br><span class="line">==&gt; googlecompute: Creating temporary SSH key for instance...</span><br><span class="line">==&gt; googlecompute: Using image: debian-7-wheezy-v20150127</span><br><span class="line">==&gt; googlecompute: Creating instance...</span><br><span class="line">    googlecompute: Loading zone: us-central1-a</span><br><span class="line">    googlecompute: Loading machine type: n1-standard-1</span><br><span class="line">    googlecompute: Requesting instance creation...</span><br><span class="line">    googlecompute: Waiting for creation operation to complete...</span><br><span class="line">    googlecompute: Instance has been created!</span><br><span class="line">==&gt; googlecompute: Waiting for the instance to become running...</span><br><span class="line">    googlecompute: IP: 35.202.237.72</span><br><span class="line">==&gt; googlecompute: Using ssh communicator to connect: 35.202.237.72</span><br><span class="line">==&gt; googlecompute: Waiting for SSH to become available...</span><br><span class="line">==&gt; googlecompute: Connected to SSH!</span><br><span class="line">==&gt; googlecompute: Deleting instance...</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    googlecompute: Instance has been deleted!</span><br><span class="line">==&gt; googlecompute: Creating image...</span><br><span class="line">==&gt; googlecompute: Deleting disk...</span><br><span class="line">    googlecompute: Disk has been deleted!</span><br><span class="line">Build &apos;googlecompute&apos; finished.</span><br><span class="line"></span><br><span class="line">==&gt; Builds finished. The artifacts of successful builds are:</span><br><span class="line">--&gt; googlecompute: A disk image was created: packer-1541417917</span><br></pre></td></tr></table></figure><p><img src="/archives/bc880644/01.png" alt=""></p><h1 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h1><ul><li>Packer官网：<a href="https://www.packer.io/" target="_blank" rel="noopener">https://www.packer.io/</a></li></ul><p>======================================================<br>希望各位朋友支持一下</p><ul><li>领取我的<a href="https://promotion.aliyun.com/ntms/act/ambassador/sharetouser.html?userCode=xpdsz87p&amp;utm_source=xpdsz87p" target="_blank" rel="noopener">阿里云幸运券</a>,谢谢.</li><li>使用<a href="https://cloud.tencent.com/redirect.php?redirect=1005&amp;cps_key=5a162632de40024cd01aabff4d3f1370" target="_blank" rel="noopener">腾讯云资源</a></li><li><a href="https://www.linode.com/?r=82f5a02930ac529c4176aff09c1513cf9e7b4418" target="_blank" rel="noopener">Linode VPS</a></li><li><a href="https://bandwagonhost.com/aff.php?aff=38634" target="_blank" rel="noopener">搬瓦工VPS</a></li><li>阿里云1888元云产品通用代金券<a href="https://promotion.aliyun.com/ntms/yunparter/invite.html?userCode=xpdsz87p" target="_blank" rel="noopener">点我</a></li><li>阿里云最新活动<a href="https://promotion.aliyun.com/ntms/act/vmpt/aliyun-group/home.html?userCode=xpdsz87p" target="_blank" rel="noopener">全民云计算升级-拼团上云更优惠</a></li></ul><p><strong>本文作者</strong>：dongsheng<br><strong>本文地址</strong>： <a href="https://mds1455975151.github.io/archives/bc880644.html">https://mds1455975151.github.io/archives/bc880644.html</a><br><strong>版权声明</strong>：转载请注明出处！</p><!-- rebuild by neat -->]]></content>
    
    <summary type="html">
    
      Packer之Packer介绍
    
    </summary>
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/categories/DevOps/"/>
    
    
      <category term="DevOps" scheme="https://mds1455975151.github.io/tags/DevOps/"/>
    
      <category term="Packer" scheme="https://mds1455975151.github.io/tags/Packer/"/>
    
      <category term="镜像制作" scheme="https://mds1455975151.github.io/tags/%E9%95%9C%E5%83%8F%E5%88%B6%E4%BD%9C/"/>
    
      <category term="Aliyun" scheme="https://mds1455975151.github.io/tags/Aliyun/"/>
    
      <category term="资源编排" scheme="https://mds1455975151.github.io/tags/%E8%B5%84%E6%BA%90%E7%BC%96%E6%8E%92/"/>
    
      <category term="google Cloud" scheme="https://mds1455975151.github.io/tags/google-Cloud/"/>
    
      <category term="googlecompute" scheme="https://mds1455975151.github.io/tags/googlecompute/"/>
    
  </entry>
  
</feed>
